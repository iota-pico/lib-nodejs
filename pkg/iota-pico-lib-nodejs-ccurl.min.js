module.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(n,s,function(t){return e[t]}.bind(null,s));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=53)}([function(e,t){Object.defineProperty(t,"__esModule",{value:!0});class r{static isEmpty(e){return null==e}static isObject(e){return null!=e&&("object"==typeof e&&!Array.isArray(e))}static isType(e,t){const n=r.getClassName(e);return void 0!==n&&n===r.getClassName(t)}static getClassName(e){if(null==e)return;const t=("function"==typeof e?e.toString():e.constructor.toString()).match(/\w+/g);return t&&t.length>1?t[1]:void 0}}t.ObjectHelper=r},function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",function(){return s}),r.d(t,"__assign",function(){return o}),r.d(t,"__rest",function(){return i}),r.d(t,"__decorate",function(){return a}),r.d(t,"__param",function(){return u}),r.d(t,"__metadata",function(){return c}),r.d(t,"__awaiter",function(){return l}),r.d(t,"__generator",function(){return h}),r.d(t,"__exportStar",function(){return d}),r.d(t,"__values",function(){return p}),r.d(t,"__read",function(){return y}),r.d(t,"__spread",function(){return g}),r.d(t,"__await",function(){return f}),r.d(t,"__asyncGenerator",function(){return T}),r.d(t,"__asyncDelegator",function(){return m}),r.d(t,"__asyncValues",function(){return b}),r.d(t,"__makeTemplateObject",function(){return _}),r.d(t,"__importStar",function(){return w}),r.d(t,"__importDefault",function(){return E});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function s(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};function i(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&(r[n[s]]=e[n[s]])}return r}function a(e,t,r,n){var s,o=arguments.length,i=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(i=(o<3?s(i):o>3?s(t,r,i):s(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i}function u(e,t){return function(r,n){t(r,n,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))(function(s,o){function i(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){e.done?s(e.value):new r(function(t){t(e.value)}).then(i,a)}u((n=n.apply(e,t||[])).next())})}function h(e,t){var r,n,s,o,i={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(s=2&o[0]?n.return:o[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,o[1])).done)return s;switch(n=0,s&&(o=[2&o[0],s.value]),o[0]){case 0:case 1:s=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(s=(s=i.trys).length>0&&s[s.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){i.label=o[1];break}if(6===o[0]&&i.label<s[1]){i.label=s[1],s=o;break}if(s&&i.label<s[2]){i.label=s[2],i.ops.push(o);break}s[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],n=0}finally{r=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function d(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}function p(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function y(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,s,o=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)i.push(n.value)}catch(e){s={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(s)throw s.error}}return i}function g(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e}function f(e){return this instanceof f?(this.v=e,this):new f(e)}function T(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,s=r.apply(e,t||[]),o=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(e){s[e]&&(n[e]=function(t){return new Promise(function(r,n){o.push([e,t,r,n])>1||a(e,t)})})}function a(e,t){try{(r=s[e](t)).value instanceof f?Promise.resolve(r.value.v).then(u,c):l(o[0][2],r)}catch(e){l(o[0][3],e)}var r}function u(e){a("next",e)}function c(e){a("throw",e)}function l(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}function m(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,s){t[n]=e[n]?function(t){return(r=!r)?{value:f(e[n](t)),done:"return"===n}:s?s(t):t}:s}}function b(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=p(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,s){(function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)})(n,s,(t=e[r](t)).done,t.value)})}}}function _(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function w(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function E(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(3),s=r(5),o=r(4);class i{constructor(e){this._trytes=e}static fromString(e,t=0){if(!s.StringHelper.isString(e))throw new o.DataError("The value must be a non empty string");if(!n.NumberHelper.isInteger(t)||t<0)throw new o.DataError("The length must be >= 0");if(!i.isValid(e,t))throw new o.DataError("The value and length do not contain valid trytes",{value:e,length:t});return new i(e)}static isValid(e,t=0){return!!s.StringHelper.isString(e)&&new RegExp(`^[9A-Z]{${t||"0,"}}$`).test(e)}toString(){return this._trytes}length(){return this._trytes.length}sub(e,t){if(!n.NumberHelper.isInteger(e)||e<0)throw new o.DataError("The start must be a number >= 0");if(!n.NumberHelper.isInteger(t)||e+t>this._trytes.length)throw new o.DataError(`The start + length must <= ${this._trytes.length}`);return i.fromString(this._trytes.substr(e,t))}}i.ALPHABET="9ABCDEFGHIJKLMNOPQRSTUVWXYZ",t.Trytes=i},function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.NumberHelper=class{static isInteger(e){return Number.isInteger(e)&&!Number.isNaN(e)&&Number.isFinite(e)}static isNumber(e){return null!=e&&"number"==typeof e&&!Number.isNaN(e)&&Number.isFinite(e)}static isFloatString(e){return/^-?\d*\.?\d+$/.test(e)}static isIntegerString(e){return/^-?\d+$/.test(e)}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(11);t.DataError=class extends n.CoreError{constructor(e,t,r){super(e,t,r),this.domain="Data"}}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0});class r{static isString(e){return null!=e&&"[object String]"===Object.prototype.toString.call(e)}static isEmpty(e){return!r.isString(e)||0===e.length}static isASCII(e){return null!=e&&/^[\x00-\x7F]*$/.test(e)}static encodeNonASCII(e){return r.isString(e)?e.replace(/[\u0080-\uFFFF]/g,e=>`\\u${`0000${e.charCodeAt(0).toString(16)}`.substr(-4)}`):void 0}static decodeNonASCII(e){return r.isString(e)?e.replace(/\\u([\d\w]{4})/gi,(e,t)=>String.fromCharCode(parseInt(t,16))):void 0}}t.StringHelper=r},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(0);class s{static isArray(e){return null!=e&&Array.isArray(e)}static isEmpty(e){return!s.isArray(e)||0===e.length}static isTyped(e,t){return!s.isEmpty(e)&&!e.includes(void 0)&&!e.includes(null)&&e.every(e=>n.ObjectHelper.isType(e,t))}}t.ArrayHelper=s},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),s=r(4),o=r(2);class i{constructor(e){this._trytes=e}static fromTrytes(e){if(!n.ObjectHelper.isType(e,o.Trytes))throw new s.DataError("The hash should be a valid Trytes object");const t=e.length();if(t!==i.LENGTH)throw new s.DataError(`The hash should be ${i.LENGTH} characters in length`,{length:t});return new i(e)}toTrytes(){return this._trytes}toString(){return this._trytes.toString()}}i.LENGTH=81,i.EMPTY=i.fromTrytes(o.Trytes.fromString("9".repeat(i.LENGTH))),t.Hash=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(6),s=r(3),o=r(0),i=r(4),a=r(2);class u{constructor(e){this._trits=e}static fromArray(e){if(!o.ObjectHelper.isType(e,Int8Array))throw new i.DataError("The value does not contain valid trits");return new u(e)}static fromNumberArray(e){if(!n.ArrayHelper.isTyped(e,Number))throw new i.DataError("The value does not contain valid trits");return new u(new Int8Array(e))}static fromTrytes(e){if(!o.ObjectHelper.isType(e,a.Trytes))throw new i.DataError("The value should be a valid Trytes object");const t=e.toString(),r=new Int8Array(3*t.length);for(let e=0;e<t.length;e++){const n=a.Trytes.ALPHABET.indexOf(t.charAt(e));r[3*e]=u.TRYTES_TRITS[n][0],r[3*e+1]=u.TRYTES_TRITS[n][1],r[3*e+2]=u.TRYTES_TRITS[n][2]}return new u(r)}static fromNumber(e){if(!s.NumberHelper.isInteger(e))throw new i.DataError("The value is not an integer");const t=[];let r=e<0?-e:e;for(;r>0;){let e=r%3;r=Math.floor(r/3),e>1&&(e=-1,r++),t[t.length]=e}if(e<0)for(let e=0;e<t.length;e++)t[e]=-t[e];return new u(new Int8Array(t))}static add(e,t){if(!o.ObjectHelper.isType(e,u))throw new i.DataError("The first should be a valid Trits object");if(!o.ObjectHelper.isType(t,u))throw new i.DataError("The seconds should be a valid Trits object");const r=new Int8Array(Math.max(e._trits.length,t._trits.length));let n,s,a=0;for(let o=0;o<r.length;o++){n=o<e._trits.length?e._trits[o]:0,s=o<t._trits.length?t._trits[o]:0;const i=u.fullAdd(n,s,a);r[o]=i[0],a=i[1]}return u.fromArray(r)}static fullAdd(e,t,r){const n=u.sum(e,t),s=u.cons(e,t),o=u.cons(n,r),i=u.any(s,o),a=u.sum(n,r);return new Int8Array([a,i])}static sum(e,t){const r=e+t;switch(r){case 2:return-1;case-2:return 1;default:return r}}static cons(e,t){return e===t?e:0}static any(e,t){const r=e+t;return r>0?1:r<0?-1:0}toArray(){return this._trits}toNumberArray(){return Array.from(this._trits)}toTrytes(){let e="";for(let t=0;t<this._trits.length;t+=3)for(let r=0;r<a.Trytes.ALPHABET.length;r++)if(u.TRYTES_TRITS[r][0]===this._trits[t]&&u.TRYTES_TRITS[r][1]===this._trits[t+1]&&u.TRYTES_TRITS[r][2]===this._trits[t+2]){e+=a.Trytes.ALPHABET.charAt(r);break}return a.Trytes.fromString(e)}toNumber(){let e=0;for(let t=this._trits.length-1;t>=0;t--)e=3*e+this._trits[t];return e}length(){return this._trits.length}sub(e,t){if(!s.NumberHelper.isInteger(e)||e<0)throw new i.DataError("The start must be a number >= 0");if(!s.NumberHelper.isInteger(t)||e+t>this._trits.length)throw new i.DataError(`The start + length must <= ${this._trits.length}`);return u.fromArray(this._trits.slice(e,e+t))}}u.TRYTES_TRITS=[new Int8Array([0,0,0]),new Int8Array([1,0,0]),new Int8Array([-1,1,0]),new Int8Array([0,1,0]),new Int8Array([1,1,0]),new Int8Array([-1,-1,1]),new Int8Array([0,-1,1]),new Int8Array([1,-1,1]),new Int8Array([-1,0,1]),new Int8Array([0,0,1]),new Int8Array([1,0,1]),new Int8Array([-1,1,1]),new Int8Array([0,1,1]),new Int8Array([1,1,1]),new Int8Array([-1,-1,-1]),new Int8Array([0,-1,-1]),new Int8Array([1,-1,-1]),new Int8Array([-1,0,-1]),new Int8Array([0,0,-1]),new Int8Array([1,0,-1]),new Int8Array([-1,1,-1]),new Int8Array([0,1,-1]),new Int8Array([1,1,-1]),new Int8Array([-1,-1,0]),new Int8Array([0,-1,0]),new Int8Array([1,-1,0]),new Int8Array([-1,0,0])],t.Trits=u},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(11);t.CryptoError=class extends n.CoreError{constructor(e,t,r){super(e,t,r),this.domain="Crypto"}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),s=r(4),o=r(2);class i{constructor(e,t){this._addressTrytes=e,this._checksumTrytes=t}static fromTrytes(e){if(!n.ObjectHelper.isType(e,o.Trytes))throw new s.DataError("The address should be a valid Trytes object");const t=e.toString();if(t.length!==i.LENGTH&&t.length!==i.LENGTH_WITH_CHECKSUM)throw new s.DataError(`The address should either be ${i.LENGTH} or ${i.LENGTH_WITH_CHECKSUM} characters in length`,{length:t.length});const r=t.substr(0,i.LENGTH);let a;return t.length===i.LENGTH_WITH_CHECKSUM&&(a=t.substr(i.LENGTH)),new i(r,a)}toTrytes(){return o.Trytes.fromString(this._addressTrytes)}toTrytesWithChecksum(){if(!n.ObjectHelper.isEmpty(this._checksumTrytes))return o.Trytes.fromString(this._addressTrytes+this._checksumTrytes);throw new s.DataError("This address has no checksum calculated for it")}toString(){return n.ObjectHelper.isEmpty(this._checksumTrytes)?this._addressTrytes:this._addressTrytes+this._checksumTrytes}}i.LENGTH=81,i.LENGTH_CHECKSUM=9,i.LENGTH_WITH_CHECKSUM=i.LENGTH+i.LENGTH_CHECKSUM,i.EMPTY=i.fromTrytes(o.Trytes.fromString("9".repeat(i.LENGTH))),t.Address=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(19),s=r(5);t.CoreError=class extends Error{constructor(e,t,r){super(e),this.additional=t||{},this.innerError=r,this.domain="Core"}static isError(e){return null!=e&&"object"==typeof e&&"message"in e&&"additional"in e}format(){let e="";s.StringHelper.isEmpty(this.domain)||(e+=`${this.domain}: `),s.StringHelper.isEmpty(this.message)||(e+=`${this.message}`);const t=Object.keys(this.additional);return t.length>0&&(e.length>0&&(e+="\n"),t.forEach(t=>{e+=`\t${t}: ${n.JsonHelper.stringify(this.additional[t])}\n`})),e}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),s=r(4),o=r(2);class i{constructor(e){this._trytes=e}static fromTrytes(e){if(!n.ObjectHelper.isType(e,o.Trytes))throw new s.DataError("The tag should be a valid Trytes object");let t=e.toString();if(t.length>i.LENGTH)throw new s.DataError(`The tag should be at most ${i.LENGTH} characters in length`,{length:t.length});for(;t.length<i.LENGTH;)t+="9";return new i(t)}toTrytes(){return o.Trytes.fromString(this._trytes)}toString(){return this._trytes}}i.LENGTH=27,i.EMPTY=i.fromTrytes(o.Trytes.fromString("9".repeat(i.LENGTH))),t.Tag=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),s=r(4),o=r(2);class i{constructor(e){this._trytes=e}static fromTrytes(e){if(!n.ObjectHelper.isType(e,o.Trytes))throw new s.DataError("The signatureMessageFragment should be a valid Trytes object");const t=e.length();if(t!==i.LENGTH)throw new s.DataError(`The signatureMessageFragment should be ${i.LENGTH} characters in length`,{length:t});return new i(e)}toTrytes(){return this._trytes}toString(){return this._trytes.toString()}}i.LENGTH=2187,i.EMPTY=i.fromTrytes(o.Trytes.fromString("9".repeat(i.LENGTH))),t.SignatureMessageFragment=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),s=r(4),o=r(10),i=r(7),a=r(13),u=r(12),c=r(17),l=r(2);class h{constructor(){}static fromParams(e,t,r,n,s,o,i,a,u,l,d,p,y,g,f){const T=new h;return T.signatureMessageFragment=e,T.address=t,T.value=c.TryteNumber.fromNumber(r,11),T.obsoleteTag=n,T.timestamp=c.TryteNumber.fromNumber(s),T.currentIndex=c.TryteNumber.fromNumber(o),T.lastIndex=c.TryteNumber.fromNumber(i),T.bundle=a,T.trunkTransaction=u,T.branchTransaction=l,T.tag=d,T.attachmentTimestamp=c.TryteNumber.fromNumber(p),T.attachmentTimestampLowerBound=c.TryteNumber.fromNumber(y),T.attachmentTimestampUpperBound=c.TryteNumber.fromNumber(g),T.nonce=f,T}static fromTrytes(e){if(!n.ObjectHelper.isType(e,l.Trytes))throw new s.DataError("The trytes should be a valid Trytes object");const t=e.length();if(t!==h.LENGTH)throw new s.DataError(`The trytes must be ${h.LENGTH} in length`,{length:t});const r=e.sub(2279,16).toString();if(r!==h.CHECK_VALUE)throw new s.DataError("The trytes between 2279 and 2295 should be all 9s",{check:r});const d=new h;let p=0;return d.signatureMessageFragment=a.SignatureMessageFragment.fromTrytes(e.sub(p,a.SignatureMessageFragment.LENGTH)),p+=a.SignatureMessageFragment.LENGTH,d.address=o.Address.fromTrytes(e.sub(p,o.Address.LENGTH)),p+=o.Address.LENGTH,d.value=c.TryteNumber.fromTrytes(e.sub(p,11),11),p+=11,p+=h.CHECK_VALUE_LENGTH,d.obsoleteTag=u.Tag.fromTrytes(e.sub(p,u.Tag.LENGTH)),p+=u.Tag.LENGTH,d.timestamp=c.TryteNumber.fromTrytes(e.sub(p,c.TryteNumber.LENGTH_9)),p+=c.TryteNumber.LENGTH_9,d.currentIndex=c.TryteNumber.fromTrytes(e.sub(p,c.TryteNumber.LENGTH_9)),p+=c.TryteNumber.LENGTH_9,d.lastIndex=c.TryteNumber.fromTrytes(e.sub(p,c.TryteNumber.LENGTH_9)),p+=c.TryteNumber.LENGTH_9,d.bundle=i.Hash.fromTrytes(e.sub(p,i.Hash.LENGTH)),p+=i.Hash.LENGTH,d.trunkTransaction=i.Hash.fromTrytes(e.sub(p,i.Hash.LENGTH)),p+=i.Hash.LENGTH,d.branchTransaction=i.Hash.fromTrytes(e.sub(p,i.Hash.LENGTH)),p+=i.Hash.LENGTH,d.tag=u.Tag.fromTrytes(e.sub(p,u.Tag.LENGTH)),p+=u.Tag.LENGTH,d.attachmentTimestamp=c.TryteNumber.fromTrytes(e.sub(p,c.TryteNumber.LENGTH_9)),p+=c.TryteNumber.LENGTH_9,d.attachmentTimestampLowerBound=c.TryteNumber.fromTrytes(e.sub(p,c.TryteNumber.LENGTH_9)),p+=c.TryteNumber.LENGTH_9,d.attachmentTimestampUpperBound=c.TryteNumber.fromTrytes(e.sub(p,c.TryteNumber.LENGTH_9)),p+=c.TryteNumber.LENGTH_9,d.nonce=u.Tag.fromTrytes(e.sub(p,u.Tag.LENGTH)),d}toTrytes(){if(!n.ObjectHelper.isType(this.signatureMessageFragment,a.SignatureMessageFragment))throw new s.DataError("The signatureMessageFragment must be set to create transaction trytes",{signatureMessageFragment:this.signatureMessageFragment});if(!n.ObjectHelper.isType(this.address,o.Address))throw new s.DataError("The address must be set to create transaction trytes",{address:this.address});if(!n.ObjectHelper.isType(this.obsoleteTag,u.Tag))throw new s.DataError("The obsoleteTag must be set to create transaction trytes",{obsoleteTag:this.obsoleteTag});if(!n.ObjectHelper.isType(this.bundle,i.Hash))throw new s.DataError("The bundle must be set to create transaction trytes",{bundle:this.bundle});if(!n.ObjectHelper.isType(this.trunkTransaction,i.Hash))throw new s.DataError("The trunkTransaction must be set to create transaction trytes",{trunkTransaction:this.trunkTransaction});if(!n.ObjectHelper.isType(this.branchTransaction,i.Hash))throw new s.DataError("The branchTransaction must be set to create transaction trytes",{branchTransaction:this.branchTransaction});if(!n.ObjectHelper.isType(this.nonce,u.Tag))throw new s.DataError("The nonce must be set to create transaction trytes",{nonce:this.nonce});const e=this.signatureMessageFragment.toTrytes().toString()+this.address.toTrytes().toString()+(this.value||h.EMPTY_11).toTrytes().toString()+h.CHECK_VALUE+this.obsoleteTag.toTrytes().toString()+(this.timestamp||c.TryteNumber.EMPTY_9).toTrytes().toString()+(this.currentIndex||c.TryteNumber.EMPTY_9).toTrytes().toString()+(this.lastIndex||c.TryteNumber.EMPTY_9).toTrytes().toString()+this.bundle.toTrytes().toString()+this.trunkTransaction.toTrytes().toString()+this.branchTransaction.toTrytes().toString()+(this.tag||this.obsoleteTag).toTrytes().toString()+(this.attachmentTimestamp||c.TryteNumber.EMPTY_9).toTrytes().toString()+(this.attachmentTimestampLowerBound||c.TryteNumber.EMPTY_9).toTrytes().toString()+(this.attachmentTimestampUpperBound||c.TryteNumber.EMPTY_9).toTrytes().toString()+this.nonce.toTrytes().toString(),t=e.length;if(t!==h.LENGTH)throw new s.DataError(`The trytes must be ${h.LENGTH} in length ${t}`,{length:t});return l.Trytes.fromString(e)}toString(){return`{\n\tsignatureMessageFragment: "${(this.signatureMessageFragment||a.SignatureMessageFragment.EMPTY).toTrytes().toString()}"\n\taddress: "${(this.address||o.Address.EMPTY).toTrytes().toString()}"\n\tvalue: ${(this.value||h.EMPTY_11).toNumber()}\n\tobsoleteTag: "${(this.obsoleteTag||u.Tag.EMPTY).toTrytes().toString()}"\n\ttimestamp: ${(this.timestamp||c.TryteNumber.EMPTY_9).toNumber()}\n\tcurrentIndex: ${(this.currentIndex||c.TryteNumber.EMPTY_9).toNumber()}\n\tlastIndex: ${(this.lastIndex||c.TryteNumber.EMPTY_9).toNumber()}\n\tbundle: "${(this.bundle||i.Hash.EMPTY).toTrytes().toString()}"\n\ttrunkTransaction: "${(this.trunkTransaction||i.Hash.EMPTY).toTrytes().toString()}"\n\tbranchTransaction: "${(this.branchTransaction||i.Hash.EMPTY).toTrytes().toString()}"\n\ttag: "${(this.tag||this.obsoleteTag||u.Tag.EMPTY).toTrytes().toString()}"\n\tattachmentTimestamp: ${(this.attachmentTimestamp||c.TryteNumber.EMPTY_9).toNumber()}\n\tattachmentTimestampLowerBound: ${(this.attachmentTimestampLowerBound||c.TryteNumber.EMPTY_9).toNumber()}\n\tattachmentTimestampUpperBound: ${(this.attachmentTimestampUpperBound||c.TryteNumber.EMPTY_9).toNumber()}\n\tnonce: "${(this.nonce||u.Tag.EMPTY).toTrytes().toString()}"\n}`}}h.LENGTH=2673,h.CHECK_VALUE_LENGTH=16,h.CHECK_VALUE="9".repeat(h.CHECK_VALUE_LENGTH),h.EMPTY_11=c.TryteNumber.fromNumber(0,11),t.Transaction=h},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(16),s=r(40),o=r(41);class i extends n.FactoryBase{constructor(){super()}static instance(){return i._instance||(i._instance=new i,i._instance.register("curl",(...e)=>new s.Curl(...e)),i._instance.register("curl81",(...e)=>new s.Curl(81)),i._instance.register("curl27",(...e)=>new s.Curl(27)),i._instance.register("kerl",(...e)=>new o.Kerl)),i._instance}getInstance(){return i.instance()}}t.SpongeFactory=i},function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.FactoryBase=class{constructor(){this._types={}}register(e,t){this.getInstance()._types[e]=t}unregister(e){delete this.getInstance()._types[e]}exists(e){return void 0!==this.getInstance()._types[e]}types(){return Object.keys(this.getInstance()._types)}create(e,...t){const r=this.getInstance();if(r._types[e])return r._types[e](...t)}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(3),s=r(0),o=r(4),i=r(8),a=r(2);class u{constructor(e){this._trytes=e}static fromNumber(e,t=u.LENGTH_9){let r;if(!n.NumberHelper.isInteger(t)||t<=0)throw new o.DataError("The length should be a number > 0",{length:t});if(s.ObjectHelper.isEmpty(e))r="9".repeat(t);else{if(!n.NumberHelper.isInteger(e))throw new o.DataError("The value is not an integer",{value:e});const s=i.Trits.fromNumber(e).toNumberArray();for(;s.length<3*t;)s.push(0);r=i.Trits.fromNumberArray(s).toTrytes().toString()}return new u(r)}static fromTrytes(e,t=u.LENGTH_9){if(!s.ObjectHelper.isType(e,a.Trytes))throw new o.DataError("The value should be a valid Trytes object");let r=e.toString();if(!n.NumberHelper.isInteger(t)||t<=0)throw new o.DataError("The length should be a number > 0",{length:t});if(r.length>t)throw new o.DataError("The value contains too many characters",{length:r.length});for(;r.length<t;)r+="9";return new u(r)}toTrytes(){return a.Trytes.fromString(this._trytes)}toNumber(){return i.Trits.fromTrytes(a.Trytes.fromString(this._trytes)).toNumber()}toString(){return this._trytes}valueOf(){return this.toNumber()}}u.LENGTH_9=9,u.EMPTY_9=u.fromNumber(0,u.LENGTH_9),t.TryteNumber=u},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(11);t.BusinessError=class extends n.CoreError{constructor(e,t,r){super(e,t,r),this.domain="Business"}}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.JsonHelper=class{static stringify(e,t,r){const n=[];return JSON.stringify(e,(r,s)=>{if("object"==typeof s&&null!==e&&void 0!==s){if(-1!==n.indexOf(s))return;n.push(s)}return t?t(r,s):s},r)}}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.NullLogger=class{banner(e,...t){}log(e,...t){}info(e,...t){}warning(e,...t){}error(e,t,...r){}}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.TimeService=class{msSinceEpoch(){return Date.now()}}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.low=1]="low",e[e.medium=2]="medium",e[e.high=3]="high"}(t.AddressSecurity||(t.AddressSecurity={}))},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),s=r(4),o=r(7),i=r(13),a=r(12),u=r(14),c=r(17);t.Bundle=class{constructor(){this.transactions=[]}addTransactions(e,t,r,n,s){for(let o=0;o<e;o++)this.transactions.push(u.Transaction.fromParams(void 0,t,0===o?r:0,n,s,void 0,void 0,void 0,void 0,void 0,n,void 0,void 0,void 0,void 0))}addSignatureMessageFragments(e){if(n.ObjectHelper.isEmpty(e))throw new s.DataError("The signatureMessageFragments should be an array of SignatureMessageFragments");for(let t=0;t<this.transactions.length;t++)this.transactions[t].signatureMessageFragment=e[t]||i.SignatureMessageFragment.EMPTY,this.transactions[t].trunkTransaction=o.Hash.EMPTY,this.transactions[t].branchTransaction=o.Hash.EMPTY,this.transactions[t].attachmentTimestamp=c.TryteNumber.EMPTY_9,this.transactions[t].attachmentTimestampLowerBound=c.TryteNumber.EMPTY_9,this.transactions[t].attachmentTimestampUpperBound=c.TryteNumber.EMPTY_9,this.transactions[t].nonce=a.Tag.EMPTY}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(6),s=r(3),o=r(0),i=r(10),a=r(22),u=r(7),c=r(13),l=r(8),h=r(2),d=r(9),p=r(15);class y{static subseed(e,t,r="curl27"){if(!o.ObjectHelper.isType(e,Int8Array))throw new d.CryptoError("The seed must be of type Int8Array");if(!s.NumberHelper.isInteger(t)||t<0)throw new d.CryptoError("The index must be an integer >= 0");if(!p.SpongeFactory.instance().exists(r))throw new d.CryptoError(`The spongeType must be one of [${p.SpongeFactory.instance().types().join(", ")}]`);const n=p.SpongeFactory.instance().create(r),i=n.getConstant("HASH_LENGTH");n.initialize();const a=e.slice();let u=t;for(;u-- >0;)for(let e=0;e<a.length&&++a[e]>y.MAX_TRIT_VALUE;e++)a[e]=y.MIN_TRIT_VALUE;const c=new Int8Array(i);return n.absorb(a,0,a.length),n.squeeze(c,0,c.length),c}static key(e,t,r,n="kerl"){if(!o.ObjectHelper.isType(e,u.Hash))throw new d.CryptoError("The seed must be of type Hash");if(!s.NumberHelper.isInteger(t)||t<0)throw new d.CryptoError("The index must be an integer >= 0");if(!s.NumberHelper.isInteger(r)||r<a.AddressSecurity.low||r>a.AddressSecurity.high)throw new d.CryptoError("The security must be an integer >= 1 and <= 3");if(!p.SpongeFactory.instance().exists(n))throw new d.CryptoError(`The spongeType must be one of [${p.SpongeFactory.instance().types().join(", ")}]`);const i=l.Trits.fromTrytes(e.toTrytes()),c=l.Trits.fromNumber(t),h=l.Trits.add(i,c).toArray(),g=h.length,f=p.SpongeFactory.instance().create(n),T=f.getConstant("HASH_LENGTH");f.initialize(),f.absorb(h,0,g),f.squeeze(h,0,g),f.reset(),f.absorb(h,0,g);const m=new Int8Array(y.NUMBER_OF_FRAGMENT_CHUNKS*T*r);let b=0;const _=new Int8Array(g);let w=r;for(;w-- >0;)for(let e=0;e<y.NUMBER_OF_FRAGMENT_CHUNKS;e++){f.squeeze(_,0,g);for(let e=0;e<T;e++)m[b++]=_[e]}return m}static digests(e,t="kerl"){if(!o.ObjectHelper.isType(e,Int8Array))throw new d.CryptoError("The subseed must be of type Int8Array");if(!p.SpongeFactory.instance().exists(t))throw new d.CryptoError(`The spongeType must be one of [${p.SpongeFactory.instance().types().join(", ")}]`);const r=p.SpongeFactory.instance().create(t),n=r.getConstant("HASH_LENGTH"),s=n*y.NUMBER_OF_FRAGMENT_CHUNKS;if(e.length%s!=0)throw new d.CryptoError(`The subseed length must be a multiple of ${s}`);const i=y.MAX_TRYTE_VALUE-y.MIN_TRYTE_VALUE,a=e.length/s,u=new Int8Array(a*n);let c;for(let t=0;t<a;t++){const o=t*s,a=e.slice(o,o+s);for(let e=0;e<y.NUMBER_OF_FRAGMENT_CHUNKS;e++){const t=e*n;c=a.slice(t,t+n);for(let e=0;e<i;e++)r.reset(),r.absorb(c,0,c.length),r.squeeze(c,0,n);for(let e=0;e<n;e++)a[t+e]=c[e]}r.reset(),r.absorb(a,0,a.length),r.squeeze(c,0,n);const l=t*n;for(let e=0;e<n;e++)u[l+e]=c[e]}return u}static address(e,t="kerl"){if(!o.ObjectHelper.isType(e,Int8Array))throw new d.CryptoError("The digests must be of type Int8Array");if(!p.SpongeFactory.instance().exists(t))throw new d.CryptoError(`The spongeType must be one of [${p.SpongeFactory.instance().types().join(", ")}]`);const r=p.SpongeFactory.instance().create(t),n=r.getConstant("HASH_LENGTH");if(e.length%n!=0)throw new d.CryptoError(`Invalid digests length, must be a multiple of ${n}`);r.initialize(),r.absorb(e,0,e.length);const s=new Int8Array(n);return r.squeeze(s,0,s.length),s}static digest(e,t,r="kerl"){if(!o.ObjectHelper.isType(e,Int8Array))throw new d.CryptoError("The normalizedBundleFragment must be of type Int8Array");if(!o.ObjectHelper.isType(t,Int8Array))throw new d.CryptoError("The signatureMessageFragment must be of type Int8Array");if(!p.SpongeFactory.instance().exists(r))throw new d.CryptoError(`The spongeType must be one of [${p.SpongeFactory.instance().types().join(", ")}]`);let n;const s=p.SpongeFactory.instance().create(r),i=s.getConstant("HASH_LENGTH");s.initialize();for(let o=0;o<y.NUMBER_OF_FRAGMENT_CHUNKS;o++){n=new Int8Array(t.slice(o*i,(o+1)*i));for(let t=e[o]-y.MIN_TRYTE_VALUE;t>0;t--){const e=p.SpongeFactory.instance().create(r);e.initialize(),e.absorb(n,0,n.length),e.squeeze(n,0,e.getConstant("HASH_LENGTH"))}s.absorb(n,0,n.length)}return s.squeeze(n,0,s.getConstant("HASH_LENGTH")),n}static subseedToDigest(e,t,r="curl27"){if(!o.ObjectHelper.isType(e,Int8Array))throw new d.CryptoError("The subseed must be of type Int8Array");if(!s.NumberHelper.isInteger(t)||t<a.AddressSecurity.low||t>a.AddressSecurity.high)throw new d.CryptoError("The security must be an integer >= 1 and <= 3");if(!p.SpongeFactory.instance().exists(r))throw new d.CryptoError(`The spongeType must be one of [${p.SpongeFactory.instance().types().join(", ")}]`);const n=p.SpongeFactory.instance().create(r),i=p.SpongeFactory.instance().create(r),u=p.SpongeFactory.instance().create(r);n.initialize(),i.initialize(),u.initialize();const c=n.getConstant("HASH_LENGTH"),l=t*(c/3/y.RADIX*c)/c;let h=new Int8Array(c);n.absorb(e,0,e.length);for(let e=0;e<l;e++){n.squeeze(h,0,h.length);for(let e=0;e<y.MAX_TRYTE_VALUE-y.MIN_TRYTE_VALUE+1;e++)i.reset(),i.absorb(h,0,h.length),h=i.getState().slice(0,c);u.absorb(h,0,h.length)}return u.squeeze(h,0,h.length),h}static normalizedBundle(e,t="curl81"){if(!o.ObjectHelper.isType(e,u.Hash))throw new d.CryptoError("The bundleHash must be of type Hash");if(!p.SpongeFactory.instance().exists(t))throw new d.CryptoError(`The spongeType must be one of [${p.SpongeFactory.instance().types().join(", ")}]`);const r=p.SpongeFactory.instance().create(t).getConstant("HASH_LENGTH"),n=new Int8Array(y.NUMBER_OF_FRAGMENT_CHUNKS*y.NUMBER_OF_SECURITY_LEVELS),s=e.toTrytes().toString(),i=r/y.TRYTE_WIDTH/y.NUMBER_OF_SECURITY_LEVELS;for(let e=0;e<y.NUMBER_OF_SECURITY_LEVELS;e++){let t=0;for(let r=0;r<i;r++){const o=s.charAt(e*i+r),a=l.Trits.fromTrytes(h.Trytes.fromString(o)).toNumber();n[e*i+r]=a,t+=a}if(t>=0){for(;t-- >0;)for(let t=0;t<i;t++)if(n[e*i+t]>y.MIN_TRYTE_VALUE){n[e*i+t]--;break}}else for(;t++<0;)for(let t=0;t<i;t++)if(n[e*i+t]<y.MAX_TRYTE_VALUE){n[e*i+t]++;break}}return n}static validateSignatures(e,t,r,s="kerl"){if(!o.ObjectHelper.isType(e,i.Address))throw new d.CryptoError("The expectedAddress must be of type Hash");if(!n.ArrayHelper.isTyped(t,c.SignatureMessageFragment))throw new d.CryptoError("The signatureMessageFragments must be an array of type SignatureMessageFragment");if(!o.ObjectHelper.isType(r,u.Hash))throw new d.CryptoError("The bundleHash must be of type Hash");if(!p.SpongeFactory.instance().exists(s))throw new d.CryptoError(`The spongeType must be one of [${p.SpongeFactory.instance().types().join(", ")}]`);const a=[],h=y.normalizedBundle(r),g=p.SpongeFactory.instance().create(s).getConstant("HASH_LENGTH");for(let e=0;e<3;e++)a[e]=h.slice(e*y.NUMBER_OF_FRAGMENT_CHUNKS,(e+1)*y.NUMBER_OF_FRAGMENT_CHUNKS);const f=new Int8Array(t.length*g);for(let e=0;e<t.length;e++){const r=y.digest(a[e%3],l.Trits.fromTrytes(t[e].toTrytes()).toArray());for(let t=0;t<g;t++)f[e*g+t]=r[t]}return e.toTrytes().toString()===l.Trits.fromArray(y.address(f)).toTrytes().toString()}static signatureMessageFragment(e,t,r="kerl"){if(!o.ObjectHelper.isType(e,Int8Array))throw new d.CryptoError("The normalizedBundleFragment must be of type Int8Array");if(!o.ObjectHelper.isType(t,Int8Array))throw new d.CryptoError("The keyFragment must be of type Int8Array");if(!p.SpongeFactory.instance().exists(r))throw new d.CryptoError(`The spongeType must be one of [${p.SpongeFactory.instance().types().join(", ")}]`);const n=t.slice();let s;const i=p.SpongeFactory.instance().create(r),a=i.getConstant("HASH_LENGTH");for(let t=0;t<27;t++){s=n.slice(t*a,(t+1)*a);for(let r=0;r<13-e[t];r++)i.initialize(),i.reset(),i.absorb(s,0,a),i.squeeze(s,0,a);for(let e=0;e<a;e++)n[t*a+e]=s[e]}return n}}y.NUMBER_OF_FRAGMENT_CHUNKS=27,y.NUMBER_OF_SECURITY_LEVELS=3,y.TRYTE_WIDTH=3,y.MIN_TRYTE_VALUE=-13,y.MAX_TRYTE_VALUE=13,y.MIN_TRIT_VALUE=-1,y.MAX_TRIT_VALUE=1,y.RADIX=3,t.ISS=y},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(11);t.NetworkError=class extends n.CoreError{constructor(e,t,r){super(e,t,r),this.domain="Network"}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(3),s=r(0),o=r(4),i=r(10),a=r(12),u=r(2);class c{constructor(){}static fromParams(e,t,r,l){if(!s.ObjectHelper.isType(e,i.Address))throw new o.DataError("The address should be a valid Address object");if(!n.NumberHelper.isInteger(t)||t<0)throw new o.DataError("The value should be a number >= 0");if(!s.ObjectHelper.isEmpty(r)&&!s.ObjectHelper.isType(r,u.Trytes))throw new o.DataError("The message should be a valid Trytes object");if(!s.ObjectHelper.isEmpty(l)&&!s.ObjectHelper.isType(l,a.Tag))throw new o.DataError("The tag should be a valid Tag object");const h=new c;return h.address=e,h.value=t,h.message=r,h.tag=l,h}}t.Transfer=c},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),s=r(7),o=r(14),i=r(8),a=r(9),u=r(15);t.TransactionHelper=class{static hash(e){if(!n.ObjectHelper.isType(e,o.Transaction))throw new a.CryptoError("The transaction must be of type Transaction");const t=u.SpongeFactory.instance().create("curl"),r=i.Trits.fromTrytes(e.toTrytes()).toArray();t.initialize(),t.absorb(r,0,r.length);const c=new Int8Array(t.getConstant("HASH_LENGTH"));return t.squeeze(c,0,c.length),s.Hash.fromTrytes(i.Trits.fromArray(c).toTrytes())}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(6),s=r(0),o=r(15),i=r(24),a=r(10),u=r(23),c=r(7),l=r(13),h=r(12),d=r(14),p=r(8),y=r(17),g=r(2),f=r(45);class T{static isValid(e){let t=!1;if(s.ObjectHelper.isType(e,u.Bundle)&&n.ArrayHelper.isTyped(e.transactions,d.Transaction)){let r=0;const n=o.SpongeFactory.instance().create("kerl");n.initialize();const s=[];t=!0;for(let o=0;o<e.transactions.length&&t;o++){const i=e.transactions[o];if(r+=i.value.toNumber(),i.currentIndex.toNumber()!==o)t=!1;else{const t=i.toTrytes(),r=p.Trits.fromTrytes(t.sub(l.SignatureMessageFragment.LENGTH,162)).toArray();if(n.absorb(r,0,r.length),i.value.toNumber()<0){const t={address:i.address,signatureMessageFragments:[i.signatureMessageFragment]};for(let r=o;r<e.transactions.length-1;r++){const n=e.transactions[r+1];n.address.toTrytes().toString()===i.address.toTrytes().toString()&&0===n.value.toNumber()&&t.signatureMessageFragments.push(n.signatureMessageFragment)}s.push(t)}}}if(0!==r)t=!1;else{const r=new Int8Array(n.getConstant("HASH_LENGTH"));n.squeeze(r,0,r.length);const o=p.Trits.fromArray(r).toTrytes().toString(),a=e.transactions[0].bundle;if(o!==a.toTrytes().toString())t=!1;else if(e.transactions[e.transactions.length-1].currentIndex.toNumber()!==e.transactions[e.transactions.length-1].lastIndex.toNumber())t=!1;else for(let e=0;e<s.length&&t;e++){i.ISS.validateSignatures(s[e].address,s[e].signatureMessageFragments,a)||(t=!1)}}}return t}static validateSignatures(e,t){let r=!1;if(s.ObjectHelper.isType(e,u.Bundle)&&n.ArrayHelper.isTyped(e.transactions,d.Transaction)&&s.ObjectHelper.isType(t,a.Address)){let n;const s=[],o=t.toTrytes().toString();for(let t=0;t<e.transactions.length;t++)if(e.transactions[t].address.toTrytes().toString()===o){if(n=e.transactions[t].bundle,e.transactions[t].signatureMessageFragment.toTrytes().toString()===l.SignatureMessageFragment.EMPTY.toTrytes().toString())break;s.push(e.transactions[t].signatureMessageFragment)}n&&(r=i.ISS.validateSignatures(t,s,n))}return r}static prepareBundle(e,t){const r=new u.Bundle;let n,s=0;const o=[];for(let i=0;i<t.length;i++){let a=1;const u=t[i].message.toString();if(u.length>l.SignatureMessageFragment.LENGTH){a+=Math.floor(u.length/l.SignatureMessageFragment.LENGTH);let e=u;for(;e;){let t=e.slice(0,l.SignatureMessageFragment.LENGTH);e=e.slice(l.SignatureMessageFragment.LENGTH,e.length);for(let e=0;t.length<l.SignatureMessageFragment.LENGTH;e++)t+="9";o.push(l.SignatureMessageFragment.fromTrytes(g.Trytes.fromString(t)))}}else{let e="";u&&(e=u.slice(0,l.SignatureMessageFragment.LENGTH));for(let t=0;e.length<l.SignatureMessageFragment.LENGTH;t++)e+="9";o.push(l.SignatureMessageFragment.fromTrytes(g.Trytes.fromString(e)))}const c=Math.floor(e.msSinceEpoch()/1e3);n=t[i].tag,r.addTransactions(a,t[i].address,t[i].value,t[i].tag,c),s+=t[i].value}return{bundle:r,totalValue:s,lastTag:n,signatureMessageFragments:o}}static signInputs(e,t,r,n,s,o){T.finalizeBundle(t),t.addSignatureMessageFragments(n);for(let n=0;n<t.transactions.length;n++)if(t.transactions[n].value.toNumber()<0){const o=t.transactions[n].address.toTrytes().toString();let a,u;for(let e=0;e<s.length;e++)if(s[e].address.toTrytes().toString()===o){a=s[e].keyIndex,u=s[e].security?s[e].security:r.security;break}const c=i.ISS.key(e,a,u);T.signTransactions(t,n,0,c,o,u)}if(o){new f.HmacCurl(r.hmacKey).addHMAC(t)}}static signTransactions(e,t,r,n,s,o){const a=e.transactions[t].bundle,u=i.ISS.normalizedBundle(a),c=[];for(let e=0;e<3;e++)c[e]=u.slice(27*e,27*(e+1));const h=n.slice(0,6561),d=c[r],y=i.ISS.signatureMessageFragment(d,h);e.transactions[t].signatureMessageFragment=l.SignatureMessageFragment.fromTrytes(p.Trits.fromArray(y).toTrytes());for(let r=1;r<o;r++)if(e.transactions[t+r].address.toTrytes().toString()===s&&0===e.transactions[t+r].value.toNumber()){const s=n.slice(6561*r,6561*(r+1)),o=c[r],a=i.ISS.signatureMessageFragment(o,s);e.transactions[t+r].signatureMessageFragment=l.SignatureMessageFragment.fromTrytes(p.Trits.fromArray(a).toTrytes())}}static finalizeBundle(e){if(e.transactions.length>0){let t=!1;for(;!t;){const r=o.SpongeFactory.instance().create("kerl");r.initialize();for(let t=0;t<e.transactions.length;t++){e.transactions[t].currentIndex=y.TryteNumber.fromNumber(t),e.transactions[t].lastIndex=y.TryteNumber.fromNumber(e.transactions.length-1);const n=p.Trits.fromTrytes(g.Trytes.fromString(e.transactions[t].address.toTrytes().toString()+e.transactions[t].value.toTrytes().toString()+d.Transaction.CHECK_VALUE+e.transactions[t].obsoleteTag.toTrytes().toString()+e.transactions[t].timestamp.toTrytes().toString()+e.transactions[t].currentIndex.toTrytes().toString()+e.transactions[t].lastIndex.toTrytes().toString())).toArray();r.absorb(n,0,n.length)}const n=new Int8Array(r.getConstant("HASH_LENGTH"));r.squeeze(n,0,n.length);const s=c.Hash.fromTrytes(p.Trits.fromArray(n).toTrytes());for(let t=0;t<e.transactions.length;t++)e.transactions[t].bundle=s;if(-1!==i.ISS.normalizedBundle(s).indexOf(13)){const t=p.Trits.add(p.Trits.fromTrytes(e.transactions[0].obsoleteTag.toTrytes()),p.Trits.fromNumberArray([1]));e.transactions[0].obsoleteTag=h.Tag.fromTrytes(t.toTrytes())}else t=!0}}}}T.NUMBER_OF_FRAGMENT_CHUNKS=27,t.BundleHelper=T},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(11);t.PlatformError=class extends n.CoreError{constructor(e,t,r){super(e,t,r),this.domain="Platform"}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(16);class s extends n.FactoryBase{constructor(){super()}static instance(){return s._instance||(s._instance=new s),s._instance}getInstance(){return s.instance()}}t.NetworkClientFactory=s},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(16);class s extends n.FactoryBase{constructor(){super()}static instance(){return s._instance||(s._instance=new s),s._instance}getInstance(){return s.instance()}}t.PlatformCryptoFactory=s},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(16);class s extends n.FactoryBase{constructor(){super()}static instance(){return s._instance||(s._instance=new s),s._instance}getInstance(){return s.instance()}}t.RngServiceFactory=s},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(11),s=r(19),o=r(0),i=r(5);t.ErrorHelper=class{static format(e,t){if(null==e)return"unknown error";if(n.CoreError.isError(e)){let r=e.format();if(t&&e.stack){r+="\nStack Trace";const t=e.stack.split("\n");t.shift(),r+=`\n${t.join("\n")}`}return o.ObjectHelper.isEmpty(e.innerError)||(t&&!o.ObjectHelper.isEmpty(e.innerError.stack)?(r+="\n\n-----------------------------------------------",r+="\nInner Stack Trace\n",r+=e.innerError.stack):r+=`\nInner Error: ${e.innerError.message}\n`),r}if(e instanceof Error){let r="";return t&&!o.ObjectHelper.isEmpty(e.stack)?r+=e.stack:r+=e.message,r}return i.StringHelper.isString(e)?e:s.JsonHelper.stringify(e,void 0,"\t")}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(1);t.BackgroundTaskService=class{create(e,t){return n.__awaiter(this,void 0,void 0,function*(){return new Promise((r,n)=>{setTimeout(()=>{try{r(e())}catch(e){n(e)}},t)})})}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),s=r(5),o=r(2),i=r(4);t.AsciiTrytesConverter=class{to(e){if(!s.StringHelper.isString(e))throw new i.DataError("The value must be a string",{value:e});if(!s.StringHelper.isASCII(e))throw new i.DataError("The value contains non ASCII characters",{value:e});let t="";for(let r=0;r<e.length;r++){const n=e.charCodeAt(r),s=n%27,i=(n-s)/27;t+=o.Trytes.ALPHABET[s]+o.Trytes.ALPHABET[i]}return o.Trytes.fromString(t)}from(e){if(!n.ObjectHelper.isType(e,o.Trytes))throw new i.DataError("The trytes parameter is empty or not the correct type");const t=e.toString();if(t.length%2==1)throw new i.DataError("The trytes length must be an even number");let r="";for(let e=0;e<t.length;e+=2){const n=o.Trytes.ALPHABET.indexOf(t[e])+27*o.Trytes.ALPHABET.indexOf(t[e+1]);r+=String.fromCharCode(n)}return r}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(3),s=r(0),o=r(4),i=r(10),a=r(22);class u{constructor(){}static fromParams(e,t,r,c){if(!s.ObjectHelper.isType(e,i.Address))throw new o.DataError("The address should be a valid Address object");if(!n.NumberHelper.isInteger(t)||t<a.AddressSecurity.low||t>a.AddressSecurity.high)throw new o.DataError(`The security should be a number between ${a.AddressSecurity.low} and ${a.AddressSecurity.high}`);if(!n.NumberHelper.isInteger(r)||r<0)throw new o.DataError("The keyIndex should be a number >= 0");if(!n.NumberHelper.isInteger(c)||c<0)throw new o.DataError("The balance should be a number >= 0");const l=new u;return l.address=e,l.security=t,l.keyIndex=r,l.balance=c,l}}t.Input=u},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(11);t.ApiError=class extends n.CoreError{constructor(e,t,r){super(e,t,r),this.domain="API"}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(1);n.__exportStar(r(39),t),n.__exportStar(r(9),t),n.__exportStar(r(62),t),n.__exportStar(r(15),t),n.__exportStar(r(24),t),n.__exportStar(r(42),t),n.__exportStar(r(27),t),n.__exportStar(r(43),t),n.__exportStar(r(40),t),n.__exportStar(r(41),t)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),s=r(9);class o{constructor(e,t,r){this._padding=t,this._outputBits=r,this._blockCount=1600-(e<<1)>>5,this._byteCount=this._blockCount<<2,this._outputBlocks=r>>5,this._extraBytes=(31&r)>>3,this.reset()}reset(){this._reset=!0,this._block=0,this._start=0,this._blocks=new Uint32Array(this._blockCount+1),this._state=new Uint32Array(50)}update(e){if(!n.ObjectHelper.isType(e,ArrayBuffer))throw new s.CryptoError("Input is not of type ArrayBuffer");const t=new Uint8Array(e),r=t.length;let i,a=0;for(;a<r;){if(this._reset)for(this._reset=!1,this._blocks[0]=this._block,i=1;i<this._blockCount+1;++i)this._blocks[i]=0;for(i=this._start;a<r&&i<this._byteCount;++a)this._blocks[i>>2]|=t[a]<<o.SHIFT[3&i++];if(this._lastByteIndex=i,i>=this._byteCount){for(this._start=i-this._byteCount,this._block=this._blocks[this._blockCount],i=0;i<this._blockCount;++i)this._state[i]^=this._blocks[i];this.keccakPermutation(this._state),this._reset=!0}else this._start=i}}digest(){this.finalize();let e=0,t=0;const r=this._outputBits>>3;let n;n=this._extraBytes?new ArrayBuffer(this._outputBlocks+1<<2):new ArrayBuffer(r);const s=new Uint32Array(n);for(;t<this._outputBlocks;)for(e=0;e<this._blockCount&&t<this._outputBlocks;++e,++t)s[t]=this._state[e];return this._extraBytes&&(s[e]=this._state[e],n=n.slice(0,r)),this.reset(),n}finalize(){let e=this._lastByteIndex;if(this._blocks[e>>2]|=this._padding[3&e],this._lastByteIndex===this._byteCount)for(this._blocks[0]=this._blocks[this._blockCount],e=1;e<this._blockCount+1;++e)this._blocks[e]=0;for(this._blocks[this._blockCount-1]|=2147483648,e=0;e<this._blockCount;++e)this._state[e]^=this._blocks[e];this.keccakPermutation(this._state)}keccakPermutation(e){let t,r,n,s,i,a,u,c,l,h,d,p,y,g,f,T,m,b,_,w,E,H,S,A,N,v,I,C,O,j,M,P,B,L,k,x,F,G,R,U,$,D,q,Y,z,V,K,W,X,J,Z,Q,ee,te,re,ne,se,oe,ie,ae,ue,ce,le;for(n=0;n<48;n+=2)s=e[0]^e[10]^e[20]^e[30]^e[40],i=e[1]^e[11]^e[21]^e[31]^e[41],a=e[2]^e[12]^e[22]^e[32]^e[42],u=e[3]^e[13]^e[23]^e[33]^e[43],c=e[4]^e[14]^e[24]^e[34]^e[44],l=e[5]^e[15]^e[25]^e[35]^e[45],h=e[6]^e[16]^e[26]^e[36]^e[46],d=e[7]^e[17]^e[27]^e[37]^e[47],t=(p=e[8]^e[18]^e[28]^e[38]^e[48])^(a<<1|u>>>31),r=(y=e[9]^e[19]^e[29]^e[39]^e[49])^(u<<1|a>>>31),e[0]^=t,e[1]^=r,e[10]^=t,e[11]^=r,e[20]^=t,e[21]^=r,e[30]^=t,e[31]^=r,e[40]^=t,e[41]^=r,t=s^(c<<1|l>>>31),r=i^(l<<1|c>>>31),e[2]^=t,e[3]^=r,e[12]^=t,e[13]^=r,e[22]^=t,e[23]^=r,e[32]^=t,e[33]^=r,e[42]^=t,e[43]^=r,t=a^(h<<1|d>>>31),r=u^(d<<1|h>>>31),e[4]^=t,e[5]^=r,e[14]^=t,e[15]^=r,e[24]^=t,e[25]^=r,e[34]^=t,e[35]^=r,e[44]^=t,e[45]^=r,t=c^(p<<1|y>>>31),r=l^(y<<1|p>>>31),e[6]^=t,e[7]^=r,e[16]^=t,e[17]^=r,e[26]^=t,e[27]^=r,e[36]^=t,e[37]^=r,e[46]^=t,e[47]^=r,t=h^(s<<1|i>>>31),r=d^(i<<1|s>>>31),e[8]^=t,e[9]^=r,e[18]^=t,e[19]^=r,e[28]^=t,e[29]^=r,e[38]^=t,e[39]^=r,e[48]^=t,e[49]^=r,g=e[0],f=e[1],V=e[11]<<4|e[10]>>>28,K=e[10]<<4|e[11]>>>28,C=e[20]<<3|e[21]>>>29,O=e[21]<<3|e[20]>>>29,ae=e[31]<<9|e[30]>>>23,ue=e[30]<<9|e[31]>>>23,D=e[40]<<18|e[41]>>>14,q=e[41]<<18|e[40]>>>14,L=e[2]<<1|e[3]>>>31,k=e[3]<<1|e[2]>>>31,T=e[13]<<12|e[12]>>>20,m=e[12]<<12|e[13]>>>20,W=e[22]<<10|e[23]>>>22,X=e[23]<<10|e[22]>>>22,j=e[33]<<13|e[32]>>>19,M=e[32]<<13|e[33]>>>19,ce=e[42]<<2|e[43]>>>30,le=e[43]<<2|e[42]>>>30,te=e[5]<<30|e[4]>>>2,re=e[4]<<30|e[5]>>>2,x=e[14]<<6|e[15]>>>26,F=e[15]<<6|e[14]>>>26,b=e[25]<<11|e[24]>>>21,_=e[24]<<11|e[25]>>>21,J=e[34]<<15|e[35]>>>17,Z=e[35]<<15|e[34]>>>17,P=e[45]<<29|e[44]>>>3,B=e[44]<<29|e[45]>>>3,A=e[6]<<28|e[7]>>>4,N=e[7]<<28|e[6]>>>4,ne=e[17]<<23|e[16]>>>9,se=e[16]<<23|e[17]>>>9,G=e[26]<<25|e[27]>>>7,R=e[27]<<25|e[26]>>>7,w=e[36]<<21|e[37]>>>11,E=e[37]<<21|e[36]>>>11,Q=e[47]<<24|e[46]>>>8,ee=e[46]<<24|e[47]>>>8,Y=e[8]<<27|e[9]>>>5,z=e[9]<<27|e[8]>>>5,v=e[18]<<20|e[19]>>>12,I=e[19]<<20|e[18]>>>12,oe=e[29]<<7|e[28]>>>25,ie=e[28]<<7|e[29]>>>25,U=e[38]<<8|e[39]>>>24,$=e[39]<<8|e[38]>>>24,H=e[48]<<14|e[49]>>>18,S=e[49]<<14|e[48]>>>18,e[0]=g^~T&b,e[1]=f^~m&_,e[10]=A^~v&C,e[11]=N^~I&O,e[20]=L^~x&G,e[21]=k^~F&R,e[30]=Y^~V&W,e[31]=z^~K&X,e[40]=te^~ne&oe,e[41]=re^~se&ie,e[2]=T^~b&w,e[3]=m^~_&E,e[12]=v^~C&j,e[13]=I^~O&M,e[22]=x^~G&U,e[23]=F^~R&$,e[32]=V^~W&J,e[33]=K^~X&Z,e[42]=ne^~oe&ae,e[43]=se^~ie&ue,e[4]=b^~w&H,e[5]=_^~E&S,e[14]=C^~j&P,e[15]=O^~M&B,e[24]=G^~U&D,e[25]=R^~$&q,e[34]=W^~J&Q,e[35]=X^~Z&ee,e[44]=oe^~ae&ce,e[45]=ie^~ue&le,e[6]=w^~H&g,e[7]=E^~S&f,e[16]=j^~P&A,e[17]=M^~B&N,e[26]=U^~D&L,e[27]=$^~q&k,e[36]=J^~Q&Y,e[37]=Z^~ee&z,e[46]=ae^~ce&te,e[47]=ue^~le&re,e[8]=H^~g&T,e[9]=S^~f&m,e[18]=P^~A&v,e[19]=B^~N&I,e[28]=D^~L&x,e[29]=q^~k&F,e[38]=Q^~Y&V,e[39]=ee^~z&K,e[48]=ce^~te&ne,e[49]=le^~re&se,e[0]^=o.ROUND_CONSTANTS[n],e[1]^=o.ROUND_CONSTANTS[n+1]}}o.KECCAK_PADDING=new Uint32Array([1,256,65536,16777216]),o.SHIFT=new Uint8Array([0,8,16,24]),o.ROUND_CONSTANTS=new Uint32Array([1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648]),t.Sha3=o},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(3),s=r(0),o=r(9);class i{constructor(e=i.NUMBER_OF_ROUNDS){this._numberOfRounds=e}getConstant(e){switch(e){case"NUMBER_OF_ROUNDS":return this._numberOfRounds;case"HASH_LENGTH":case"STATE_LENGTH":return i[e];default:throw new o.CryptoError(`Unknown constant requested ${e}`)}}getState(){return this._state}initialize(e){this._state=e||new Int8Array(i.STATE_LENGTH)}reset(){this.initialize()}absorb(e,t,r){if(!s.ObjectHelper.isType(e,Int8Array)||0===e.length)throw new o.CryptoError("Trits must be a non empty Int8Array");if(!n.NumberHelper.isInteger(t)||t<0)throw new o.CryptoError("Offset must be a number >= 0");if(!n.NumberHelper.isInteger(r)||r<0)throw new o.CryptoError("Length must be a number >= 0");if(r+t>e.length)throw new o.CryptoError("The offset + length is beyond the length of the trits");let a=t,u=r;do{let t=0;const r=u<i.HASH_LENGTH?u:i.HASH_LENGTH;for(;t<r;)this._state[t++]=e[a++];this.transform(),u-=i.HASH_LENGTH}while(u>0)}squeeze(e,t,r){if(!s.ObjectHelper.isType(e,Int8Array)||0===e.length)throw new o.CryptoError("Trits must be a non empty Int8Array");if(!n.NumberHelper.isInteger(t)||t<0)throw new o.CryptoError("Offset must be a number >= 0");if(!n.NumberHelper.isInteger(r)||r<0)throw new o.CryptoError("Length must be a number >= 0");if(r+t>e.length)throw new o.CryptoError("The offset + length is beyond the length of the trits");let a=t,u=r;do{let t=0;const n=u<i.HASH_LENGTH?r:i.HASH_LENGTH;for(;t<n;)e[a++]=this._state[t++];this.transform(),u-=i.HASH_LENGTH}while(u>0)}transform(){let e,t=0;for(let r=0;r<this._numberOfRounds;r++){e=new Int8Array(this._state.slice());for(let r=0;r<i.STATE_LENGTH;r++)this._state[r]=i.TRUTH_TABLE[e[t]+(e[t+=t<365?364:-365]<<2)+5]}}}i.HASH_LENGTH=243,i.NUMBER_OF_ROUNDS=81,i.STATE_LENGTH=3*i.HASH_LENGTH,i.TRUTH_TABLE=new Int8Array([1,0,-1,2,1,-1,0,2,-1,1,0]),t.Curl=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(3),s=r(0),o=r(39),i=r(9),a=r(42);class u{constructor(){this._keccak=new o.Sha3(384,o.Sha3.KECCAK_PADDING,384)}getConstant(e){switch(e){case"HASH_LENGTH":case"BIT_HASH_LENGTH":case"BYTE_HASH_LENGTH":return u[e];default:throw new i.CryptoError(`Unknown constant requested ${e}`)}}getState(){}initialize(e){}reset(){this._keccak.reset()}absorb(e,t,r){if(!s.ObjectHelper.isType(e,Int8Array)||0===e.length)throw new i.CryptoError("Trits must be a non empty Int8Array");if(!n.NumberHelper.isInteger(t)||t<0)throw new i.CryptoError("Offset must be a number >= 0");if(!n.NumberHelper.isInteger(r)||r<0)throw new i.CryptoError("Length must be a number >= 0");if(r+t>e.length)throw new i.CryptoError("The offset + length is beyond the length of the trits");if(r%243!=0)throw new i.CryptoError(`Length must be a multiple of ${u.HASH_LENGTH}`,{length:r});let o=t,c=r;do{const t=e.slice(o,o+u.HASH_LENGTH);t[u.HASH_LENGTH-1]=0;const r=a.BigIntegerHelper.tritsToBigInteger(t,0,t.length),n=new ArrayBuffer(u.BYTE_HASH_LENGTH);a.BigIntegerHelper.bigIntegerToBytes(r,n,0),this._keccak.update(n),o+=u.HASH_LENGTH,c-=u.HASH_LENGTH}while(c>0)}squeeze(e,t,r){if(!s.ObjectHelper.isType(e,Int8Array)||0===e.length)throw new i.CryptoError("Trits must be a non empty Int8Array");if(!n.NumberHelper.isInteger(t)||t<0)throw new i.CryptoError("Offset must be a number >= 0");if(!n.NumberHelper.isInteger(r)||r<0)throw new i.CryptoError("Length must be a number >= 0");if(r+t>e.length)throw new i.CryptoError("The offset + length is beyond the length of the trits");if(r%243!=0)throw new i.CryptoError(`Length must be a multiple of ${u.HASH_LENGTH}`,{length:r});let o=t,c=r;do{const t=this._keccak.digest(),r=a.BigIntegerHelper.bytesToBigInteger(t,0,u.BYTE_HASH_LENGTH),n=new Int8Array(u.HASH_LENGTH);a.BigIntegerHelper.bigIntegerToTrits(r,n,0,u.HASH_LENGTH),n[u.HASH_LENGTH-1]=0;let s=0;for(;s<u.HASH_LENGTH;)e[o++]=n[s++];const i=new DataView(t);for(s=0;s<i.byteLength;s++)i.setUint8(s,255^i.getUint8(s));this._keccak.update(t),c-=u.HASH_LENGTH}while(c>0)}}u.HASH_LENGTH=243,u.BIT_HASH_LENGTH=384,u.BYTE_HASH_LENGTH=u.BIT_HASH_LENGTH/8,t.Kerl=u},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),s=r(3),o=r(0),i=n.__importDefault(r(63)),a=r(9);class u{static tritsToBigInteger(e,t,r){if(!o.ObjectHelper.isType(e,Int8Array)||0===e.length)throw new a.CryptoError("The trits must be a non empty Int8Array");if(!s.NumberHelper.isInteger(t)||t<0)throw new a.CryptoError("The offset must be a number >= 0");if(!s.NumberHelper.isInteger(r)||r<=0)throw new a.CryptoError("The length must be a number > 0");if(t+r>e.length)throw new a.CryptoError("The offset + length is beyond the length of the array");let n=i.default.zero;for(let s=r-1;s>=0;s--)n=n.multiply(u.RADIX).add(i.default(e[t+s]));return n}static bigIntegerToTrits(e,t,r,n){if(!o.ObjectHelper.isType(e,i.default))throw new a.CryptoError("The value must be a bigInteger type");if(!o.ObjectHelper.isType(t,Int8Array))throw new a.CryptoError("The trits must be an Int8Array");if(!s.NumberHelper.isInteger(r)||r<0)throw new a.CryptoError("The offset must be a number >= 0");if(!s.NumberHelper.isInteger(n)||n<=0)throw new a.CryptoError("The length must be a number > 0");if(r+n>t.length)throw new a.CryptoError("The offset + length is beyond the length of the array");let c=e.compareTo(i.default.zero)<0?e.negate():e;for(let e=0;e<n;e++){const n=c.divmod(u.RADIX);c=n.quotient;let s=n.remainder;s>u.MAX_TRIT_VALUE&&(s=u.MIN_TRIT_VALUE,c=c.add(i.default[1])),t[r+e]=s.toJSNumber()}if(e.compareTo(i.default.zero)<0)for(let e=0;e<n;e++)t[r+e]=0===t[r+e]?0:-t[r+e]}static bigIntegerToBytes(e,t,r){if(!o.ObjectHelper.isType(e,i.default))throw new a.CryptoError("The value must be a bigInteger type");if(!o.ObjectHelper.isType(t,ArrayBuffer)||0===t.byteLength)throw new a.CryptoError("The destination must be an array");if(!s.NumberHelper.isInteger(r)||r<0)throw new a.CryptoError("The offset must be a number >= 0");if(t.byteLength-r<u.BYTE_HASH_LENGTH)throw new a.CryptoError(`Destination array has invalid size, it must be at least ${u.BYTE_HASH_LENGTH}`);const n=e.isNegative()?-1:0;let c=e.toString(16);-1===n&&(c=c.slice(1)),c.length%2==1&&(c=`0${c}`);const l=c.match(/[0-9a-f]{2}/g),h=new Int8Array(l.map(e=>parseInt(`0x${e}`,16)));-1===n&&u.twosComplement(h);const d=new DataView(t);let p=r;for(;p+h.length<u.BYTE_HASH_LENGTH;)d.setInt8(p++,n);for(let e=h.length;e-- >0;)d.setInt8(p++,h[h.length-1-e])}static bytesToBigInteger(e,t,r){if(!o.ObjectHelper.isType(e,ArrayBuffer)||0===e.byteLength)throw new a.CryptoError("The source must be a non empty number array");if(!s.NumberHelper.isInteger(t)||t<0)throw new a.CryptoError("The offset must be a number >= 0");if(!s.NumberHelper.isInteger(r)||r<=0)throw new a.CryptoError("The length must be a number > 0");if(e.byteLength-t<u.BYTE_HASH_LENGTH)throw new a.CryptoError(`Source array has invalid size, it must be at least ${u.BYTE_HASH_LENGTH}`);const n=new DataView(e);let c=new Int8Array(n.byteLength);for(let e=0;e<n.byteLength;e++)c[e]=n.getInt8(e+t);let l=0;const h=c[0],d=h<0;if(0===h||-1===h){for(;c[l]===h&&l<c.length-1;)l++;c=c.slice(l)}d&&u.twosComplement(c);let p=d?"-":"";const y=new DataView(c.buffer);for(let e=0;e<y.byteLength;e++)p+=`00${y.getUint8(e).toString(16)}`.slice(-2);return i.default(p,16)}static twosComplement(e){for(let t=0;t<e.length;t++)e[t]=~e[t];let t=e.length-1;do{e[t]++}while(0===e[t--]&&t>0)}}u.RADIX=i.default(3),u.MAX_TRIT_VALUE=u.RADIX.minus(1).divide(2),u.MIN_TRIT_VALUE=u.MAX_TRIT_VALUE.negate(),u.BIT_HASH_LENGTH=384,u.BYTE_HASH_LENGTH=u.BIT_HASH_LENGTH/8,t.BigIntegerHelper=u},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),s=r(6),o=r(3),i=r(0),a=r(21),u=r(7),c=r(12),l=r(14),h=r(17),d=r(2),p=r(9),y=r(27);class g{constructor(e){this._timeService=e||new a.TimeService}initialize(){return n.__awaiter(this,void 0,void 0,function*(){return Promise.resolve()})}pow(e,t,r,a){return n.__awaiter(this,void 0,void 0,function*(){if(!i.ObjectHelper.isType(e,u.Hash))throw new p.CryptoError("The trunkTransaction must be an object of type Hash");if(!i.ObjectHelper.isType(t,u.Hash))throw new p.CryptoError("The branchTransaction must be an object of type Hash");if(!s.ArrayHelper.isTyped(r,d.Trytes))throw new p.CryptoError("The trytes must be an array of type Trytes");if(!o.NumberHelper.isInteger(a)||a<=0)throw new p.CryptoError("The minWeightMagnitude must be > 0");const n=[];let f;for(let s=0;s<r.length;s++){const o=l.Transaction.fromTrytes(r[s]);if(o.attachmentTimestamp=h.TryteNumber.fromNumber(this._timeService.msSinceEpoch()),o.attachmentTimestampLowerBound=h.TryteNumber.fromNumber(0),o.attachmentTimestampUpperBound=h.TryteNumber.fromNumber(g.MAX_TIMESTAMP_VALUE),i.ObjectHelper.isEmpty(f)){if(o.lastIndex.toNumber()!==o.currentIndex.toNumber())throw new p.CryptoError("Wrong bundle order. The bundle should be ordered in descending order from currentIndex");o.trunkTransaction=e,o.branchTransaction=t}else o.trunkTransaction=f,o.branchTransaction=e;const u=o.toTrytes(),d=yield this.singlePow(u,a);o.nonce=c.Tag.fromTrytes(d.sub(l.Transaction.LENGTH-c.Tag.LENGTH,c.Tag.LENGTH));const T=l.Transaction.fromTrytes(d);f=y.TransactionHelper.hash(T),n.push(T)}return n.reverse().map(e=>e.toTrytes())})}}g.MAX_TIMESTAMP_VALUE=(Math.pow(3,27)-1)/2,t.ProofOfWorkBase=g},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(15),s=r(8);t.AddressHelper=class{static createChecksum(e,t){const r=n.SpongeFactory.instance().create("kerl");r.initialize(),r.absorb(e,0,e.length);const o=new Int8Array(r.getConstant("HASH_LENGTH"));return r.squeeze(o,0,o.length),s.Trits.fromArray(o).toTrytes().toString().substring(81-t,81)}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(15),s=r(13),o=r(8),i=r(2);class a{constructor(e){this._keyTrits=o.Trits.fromTrytes(e).toArray()}addHMAC(e){const t=n.SpongeFactory.instance().create("curl",a.HMAC_ROUNDS),r=t.getConstant("HASH_LENGTH"),u=this._keyTrits;for(let n=0;n<e.transactions.length;n++)if(e.transactions[n].value.toNumber()>0){const a=o.Trits.fromTrytes(e.transactions[n].bundle.toTrytes()).toArray(),c=new Int8Array(r);t.initialize(),t.absorb(u,0,u.length),t.absorb(a,0,a.length),t.squeeze(c,0,c.length);const l=o.Trits.fromArray(c).toTrytes().toString(),h=e.transactions[n].signatureMessageFragment.toTrytes().toString().substring(81,s.SignatureMessageFragment.LENGTH);e.transactions[n].signatureMessageFragment=s.SignatureMessageFragment.fromTrytes(i.Trytes.fromString(l+h))}}}a.HMAC_ROUNDS=27,t.HmacCurl=a},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(6),s=r(0),o=r(15),i=r(10),a=r(8),u=r(2),c=r(18);t.MultiSigAddress=class{constructor(){this._kerl=o.SpongeFactory.instance().create("kerl"),this._hashLength=this._kerl.getConstant("HASH_LENGTH"),this._kerl.initialize()}absorb(e){if(!n.ArrayHelper.isTyped(e,u.Trytes))throw new c.BusinessError("The digests should be an array of type Trytes");for(let t=0;t<e.length;t++){const r=a.Trits.fromTrytes(e[t]).toArray();this._kerl.absorb(r,0,r.length)}}finalize(e){s.ObjectHelper.isEmpty(e)||this.absorb(e);const t=new Int8Array(this._hashLength);return this._kerl.squeeze(t,0,t.length),i.Address.fromTrytes(a.Trits.fromArray(t).toTrytes())}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(1);n.__exportStar(r(68),t),n.__exportStar(r(48),t),n.__exportStar(r(50),t),n.__exportStar(r(51),t)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),s=r(29),o=r(0),i=r(5),a=n.__importStar(r(49));t.PlatformCrypto=class{encrypt(e,t){if(i.StringHelper.isEmpty(e))throw new s.PlatformError("The privateKey must be a non empty string");if(i.StringHelper.isEmpty(t))throw new s.PlatformError("The data must be a non empty string");const r=Buffer.from(t,"ascii");return a.privateEncrypt(e,r).toString("hex")}decrypt(e,t){if(i.StringHelper.isEmpty(e))throw new s.PlatformError("The publicKey must be a non empty string");if(i.StringHelper.isEmpty(t))throw new s.PlatformError("The data must be a non empty string");const r=Buffer.from(t,"hex");return a.publicDecrypt(e,r).toString("ascii")}sign(e,t){if(i.StringHelper.isEmpty(e))throw new s.PlatformError("The privateKey must be a non empty string");if(i.StringHelper.isEmpty(t))throw new s.PlatformError("The data must be a non empty string");const r=a.createSign("RSA-SHA256");return r.update(t),r.sign(e,"hex")}verify(e,t,r){if(i.StringHelper.isEmpty(e))throw new s.PlatformError("The publicKey must be a non empty string");if(i.StringHelper.isEmpty(t))throw new s.PlatformError("The data must be a non empty string");if(i.StringHelper.isEmpty(r))throw new s.PlatformError("The signature must be a non empty string");const n=a.createVerify("RSA-SHA256");return n.update(t),n.verify(e,r,"hex")}hash(e,t,r,n){if(i.StringHelper.isEmpty(e))throw new s.PlatformError("The algo must be a non empty string");if(i.StringHelper.isEmpty(t))throw new s.PlatformError("The data must be a non empty string");return a.createHash(e).update(t,r).digest(n)}hmac(e,t,r,n,u){if(i.StringHelper.isEmpty(e))throw new s.PlatformError("The algo must be a non empty string");if(o.ObjectHelper.isEmpty(t))throw new s.PlatformError("The key must be non empty");if(i.StringHelper.isEmpty(r))throw new s.PlatformError("The data must be a non empty string");return a.createHmac(e,t).update(r,n).digest(u)}}},function(e,t){e.exports=require("crypto")},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),s=r(25),o=r(3),i=r(0),a=r(5),u=r(20),c=n.__importStar(r(69)),l=n.__importStar(r(70));t.NetworkClient=class{constructor(e,t,r=0,n){if(i.ObjectHelper.isEmpty(e))throw new s.NetworkError("The networkEndPoint must be defined");if(!o.NumberHelper.isInteger(r)||r<0)throw new s.NetworkError("The timeoutMs must be >= 0");this._networkEndPoint=e,this._timeoutMs=r,this._logger=t||new u.NullLogger,this._httpClientRequest=n||("http"===e.getProtocol()?c.request:l.request),this._logger.banner("Network Client",{endPoint:this._networkEndPoint})}get(e,t,r){return n.__awaiter(this,void 0,void 0,function*(){this._logger.info("===> NetworkClient::GET Send");const n=yield this.doRequest("GET",this.objectToParameters(e),t,r);return this._logger.info("<=== NetworkClient::GET Received",n),n})}post(e,t,r){return n.__awaiter(this,void 0,void 0,function*(){this._logger.info("===> NetworkClient::POST Send",e);const n=yield this.doRequest("POST",e,t,r);return this._logger.info("<=== NetworkClient::POST Received",n),n})}json(e,t,r,o){return n.__awaiter(this,void 0,void 0,function*(){this._logger.info(`===> NetworkClient::${t} Send`);const n=o||{};let i;return"GET"===t||"DELETE"===t?i=this.objectToParameters(e):(n["Content-Type"]="application/json",i=JSON.stringify(e)),this.doRequest(t,i,r,n).then(e=>{try{const r=JSON.parse(e);return this._logger.info(`===> NetworkClient::${t} Received`,r),r}catch(r){throw this._logger.info(`===> NetworkClient::${t} Parse Failed`,e),new s.NetworkError(`Failed ${t} request, unable to parse response`,{endPoint:this._networkEndPoint.getUri(),response:e})}})})}doRequest(e,t,r,o){return n.__awaiter(this,void 0,void 0,function*(){return new Promise((n,u)=>{const c=o||{};let l=this._networkEndPoint.getUri(),h=this._networkEndPoint.getRootPath();if(!a.StringHelper.isEmpty(r)){const e=`/${r.replace(/^\/*/,"")}`;h+=e,l+=e}const d={protocol:`${this._networkEndPoint.getProtocol()}:`,hostname:this._networkEndPoint.getHost(),port:this._networkEndPoint.getPort(),path:h,method:e,headers:c,timeout:this._timeoutMs>0?this._timeoutMs:void 0};"GET"!==e&&"DELETE"!==e||i.ObjectHelper.isEmpty(t)||(d.path+=t);const p=this._httpClientRequest(d,t=>{let r="";t.setEncoding("utf8"),t.on("data",e=>{r+=e}),t.on("end",()=>{200===t.statusCode?n(r):(this._logger.info("<=== NetworkClient::Received Fail",{code:t.statusCode,data:r}),u(new s.NetworkError(`Failed ${e} request`,{endPoint:l,errorResponseCode:t.statusCode,errorResponse:r||t.statusMessage})))})});p.on("error",t=>{this._logger.error("<=== NetworkClient::Errored"),u(new s.NetworkError(`Failed ${e} request`,{endPoint:l,errorResponse:t}))}),p.on("timeout",t=>{this._logger.error("<=== NetworkClient::Timed Out"),u(new s.NetworkError(`Failed ${e} request, timed out`,{endPoint:l}))}),"GET"===e||"DELETE"===e||i.ObjectHelper.isEmpty(t)||p.write(t),p.end()})})}objectToParameters(e){let t="";if(e){const r=Object.keys(e);if(r.length>0){const n=[];for(let t=0;t<r.length;t++){const s=r[t],o=e[s]?e[s].toString():"";n.push(`${encodeURIComponent(r[t])}=${encodeURIComponent(o)}`)}t+=`?${n.join("&")}`}}return t}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(1).__importStar(r(49));t.RngService=class{generate(e){return new Uint8Array(n.randomBytes(e))}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),r(1).__exportStar(r(71),t)},function(e,t,r){t.default=r(54)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(1);n.__exportStar(r(55),t),n.__exportStar(r(58),t),n.__exportStar(r(60),t),n.__exportStar(r(38),t),n.__exportStar(r(64),t),n.__exportStar(r(47),t),n.__exportStar(r(52),t);const s=r(47),o=r(38),i=r(52);!function(){n.__awaiter(this,void 0,void 0,function*(){yield s.PAL.initialize(),o.ProofOfWorkFactory.instance().register("ccurl",(...e)=>new i.ProofOfWorkNodeJs(e[0]))})}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(1);n.__exportStar(r(11),t),n.__exportStar(r(25),t),n.__exportStar(r(29),t),n.__exportStar(r(16),t),n.__exportStar(r(30),t),n.__exportStar(r(31),t),n.__exportStar(r(32),t),n.__exportStar(r(6),t),n.__exportStar(r(33),t),n.__exportStar(r(19),t),n.__exportStar(r(3),t),n.__exportStar(r(5),t),n.__exportStar(r(0),t),n.__exportStar(r(56),t),n.__exportStar(r(20),t),n.__exportStar(r(57),t),n.__exportStar(r(34),t),n.__exportStar(r(21),t)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(6),s=r(33),o=r(0),i=r(5);t.ConsoleLogger=class{constructor(e){this._loggingObject=e||console}banner(e,...t){this._loggingObject.log("=".repeat(80)),this._loggingObject.log(e),this.logArgs(this._loggingObject.log,t),this._loggingObject.log("=".repeat(80))}log(e,...t){this._loggingObject.log(e),this.logArgs(this._loggingObject.log,t)}info(e,...t){this._loggingObject.info(e),this.logArgs(this._loggingObject.info,t)}warning(e,...t){this._loggingObject.warn(e),this.logArgs(this._loggingObject.warn,t)}error(e,t,...r){this._loggingObject.error(e),o.ObjectHelper.isEmpty(t)||s.ErrorHelper.format(t,!0).split("\n").forEach(e=>{this._loggingObject.error(`\t${e}`)}),this.logArgs(this._loggingObject.error,r)}logArgs(e,t){if(!n.ArrayHelper.isEmpty(t)){const r="\t";let n="";t.forEach((e,s)=>{n+=this.createItem(r,"",e),s<t.length-1&&(n+=`${r}${"-".repeat(70)}\n`)}),e(n)}}createItem(e,t,r,s="\n"){let a="";if(n.ArrayHelper.isArray(r)){const n=`${e}\t`;i.StringHelper.isEmpty(t)?a+=`${e}[\n`:a+=`${e}${t}: [\n`,r.forEach((e,t)=>{a+=this.createItem(n,"",e,`${t<r.length-1?",":""}\n`)}),a+=`${e}]\n`}else if(o.ObjectHelper.isObject(r)){const n=r.toString();if("[object Object]"===n){const n=`${e}\t`;i.StringHelper.isEmpty(t)?a+=`${e}{\n`:a+=`${e}${t}: {\n`;const s=Object.keys(r);s.forEach((e,t)=>{a+=this.createItem(n,e,r[e],`${t<s.length-1?",":""}\n`)}),a+=`${e}}\n`}else a+=this.createItem(e,t,n.replace(/\n/g,`\n${e}`),s)}else i.StringHelper.isEmpty(t)?a+=`${e}${o.ObjectHelper.isEmpty(r)?r:r.toString()}${s}`:a+=`${e}${t}: ${o.ObjectHelper.isEmpty(r)?r:r.toString()}${s}`;return a}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(25),s=r(3),o=r(0),i=r(5);class a{constructor(e,t,r,a){if(!i.StringHelper.isString(e)||!/http|https/.test(e))throw new n.NetworkError("The protocol must be defined as http or https");if(!i.StringHelper.isString(t))throw new n.NetworkError("The host must be defined");if(!s.NumberHelper.isInteger(r)||r<=0)throw new n.NetworkError("The port must be a number greater than zero");if(!o.ObjectHelper.isEmpty(a)&&!i.StringHelper.isString(a))throw new n.NetworkError("The rootPath must be a valid string");this._protocol=e,this._host=t.replace(/^\/*/,"").replace(/\/*$/,""),this._port=r,this._rootPath=(a||"").replace(/^\/*/,"").replace(/\/*$/,"")}static fromUri(e){if(i.StringHelper.isEmpty(e))throw new n.NetworkError("The uri can not be empty");const t=/^(https?):\/\/(.*?)(:\d+)?(\/.*)?$/.exec(e);if(o.ObjectHelper.isEmpty(t)||5!==t.length)throw new n.NetworkError(`The uri is not in the correct format '${e}'`);return new a(t[1],t[2],t[3]?parseInt(t[3].substr(1),10):80,t[4])}getProtocol(){return this._protocol}getHost(){return this._host}getRootPath(){return this._rootPath}getPort(){return this._port}getUri(){let e=`${this._protocol}://${this._host}:${this._port}`;return this._rootPath.length>0&&(e+=`/${this._rootPath}`),e}}t.NetworkEndPoint=a},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(1);n.__exportStar(r(35),t),n.__exportStar(r(59),t),n.__exportStar(r(10),t),n.__exportStar(r(22),t),n.__exportStar(r(23),t),n.__exportStar(r(7),t),n.__exportStar(r(36),t),n.__exportStar(r(13),t),n.__exportStar(r(12),t),n.__exportStar(r(14),t),n.__exportStar(r(26),t),n.__exportStar(r(8),t),n.__exportStar(r(17),t),n.__exportStar(r(2),t),n.__exportStar(r(4),t)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(19),s=r(0),o=r(5),i=r(2),a=r(4),u=r(35);t.ObjectTrytesConverter=class{to(e){let t;try{t=n.JsonHelper.stringify(e)}catch(e){throw new a.DataError("There was a problem converting the object to JSON",{err:e})}const r=o.StringHelper.encodeNonASCII(t);return(new u.AsciiTrytesConverter).to(r)}from(e){if(!s.ObjectHelper.isType(e,i.Trytes))throw new a.DataError("The trytes parameter is empty or not the correct type");let t=(new u.AsciiTrytesConverter).from(e);t=t.replace(/\0+$/,"");const r=o.StringHelper.decodeNonASCII(t);let n;try{n=JSON.parse(r)}catch(e){throw new a.DataError("There was a problem converting the object from JSON",{err:e})}return n}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(1);n.__exportStar(r(61),t),n.__exportStar(r(37),t)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),s=r(6),o=r(3),i=r(0),a=r(5),u=r(20),c=r(37);t.ApiClient=class{constructor(e,t="1",r,n){if(i.ObjectHelper.isEmpty(e))throw new c.ApiError("The networkClient must be defined");if(a.StringHelper.isEmpty(t))throw new c.ApiError("The apiVersion must not be empty");this._networkClient=e,this._apiVersion=t,this._additionalHeaders=r,this._logger=n||new u.NullLogger}getNodeInfo(){return n.__awaiter(this,void 0,void 0,function*(){return this.sendCommand("getNodeInfo",{})})}getNeighbors(){return n.__awaiter(this,void 0,void 0,function*(){return this.sendCommand("getNeighbors",{})})}addNeighbors(e){return n.__awaiter(this,void 0,void 0,function*(){if(i.ObjectHelper.isEmpty(e))throw new c.ApiError("The request must be defined");if(s.ArrayHelper.isEmpty(e.uris))throw new c.ApiError("The request.uris must not be empty");return this.sendCommand("addNeighbors",e)})}removeNeighbors(e){return n.__awaiter(this,void 0,void 0,function*(){if(i.ObjectHelper.isEmpty(e))throw new c.ApiError("The request must be defined");if(s.ArrayHelper.isEmpty(e.uris))throw new c.ApiError("The request.uris must not be empty");return this.sendCommand("removeNeighbors",e)})}getTips(){return n.__awaiter(this,void 0,void 0,function*(){return this.sendCommand("getTips",{})})}findTransactions(e){return n.__awaiter(this,void 0,void 0,function*(){if(i.ObjectHelper.isEmpty(e))throw new c.ApiError("The request must be defined");const t=s.ArrayHelper.isEmpty(e.bundles),r=s.ArrayHelper.isEmpty(e.addresses),n=s.ArrayHelper.isEmpty(e.tags),o=s.ArrayHelper.isEmpty(e.approvees);if(t&&r&&n&&o)throw new c.ApiError("One of the bundle, addresses, tags or approvees must not be empty");return this.sendCommand("findTransactions",e)})}getTrytes(e){return n.__awaiter(this,void 0,void 0,function*(){if(i.ObjectHelper.isEmpty(e))throw new c.ApiError("The request must be defined");if(s.ArrayHelper.isEmpty(e.hashes))throw new c.ApiError("The request.hashes must not be empty");return this.sendCommand("getTrytes",e)})}getInclusionStates(e){return n.__awaiter(this,void 0,void 0,function*(){if(i.ObjectHelper.isEmpty(e))throw new c.ApiError("The request must be defined");if(s.ArrayHelper.isEmpty(e.transactions))throw new c.ApiError("The request.transactions must not be empty");if(s.ArrayHelper.isEmpty(e.tips))throw new c.ApiError("The request.tips must not be empty");return this.sendCommand("getInclusionStates",e)})}getBalances(e){return n.__awaiter(this,void 0,void 0,function*(){if(i.ObjectHelper.isEmpty(e))throw new c.ApiError("The request must be defined");if(s.ArrayHelper.isEmpty(e.addresses))throw new c.ApiError("The request.addresses must not be empty");if(!o.NumberHelper.isInteger(e.threshold))throw new c.ApiError("The request.threshold must be a valid number");return this.sendCommand("getBalances",e)})}getTransactionsToApprove(e){return n.__awaiter(this,void 0,void 0,function*(){if(i.ObjectHelper.isEmpty(e))throw new c.ApiError("The request must be defined");if(!o.NumberHelper.isInteger(e.depth))throw new c.ApiError("The request.depth must be a valid number");if(!i.ObjectHelper.isEmpty(e.reference)&&a.StringHelper.isEmpty(e.reference))throw new c.ApiError("The request.reference must be a non empty string");if(!i.ObjectHelper.isEmpty(e.numWalks)&&!o.NumberHelper.isInteger(e.numWalks))throw new c.ApiError("The request.numWalks must be a valid number");return this.sendCommand("getTransactionsToApprove",e)})}attachToTangle(e){return n.__awaiter(this,void 0,void 0,function*(){if(i.ObjectHelper.isEmpty(e))throw new c.ApiError("The request must be defined");if(a.StringHelper.isEmpty(e.trunkTransaction))throw new c.ApiError("The request.trunkTransaction must not be empty");if(a.StringHelper.isEmpty(e.branchTransaction))throw new c.ApiError("The request.branchTransaction must not be empty");if(!o.NumberHelper.isInteger(e.minWeightMagnitude))throw new c.ApiError("The request.minWeightMagnitude must be a valid number");if(s.ArrayHelper.isEmpty(e.trytes))throw new c.ApiError("The request.trytes must not be empty");return this.sendCommand("attachToTangle",e)})}interruptAttachingToTangle(){return n.__awaiter(this,void 0,void 0,function*(){return this.sendCommand("interruptAttachingToTangle",{})})}broadcastTransactions(e){return n.__awaiter(this,void 0,void 0,function*(){if(i.ObjectHelper.isEmpty(e))throw new c.ApiError("The request must be defined");if(s.ArrayHelper.isEmpty(e.trytes))throw new c.ApiError("The request.trytes must not be empty");return this.sendCommand("broadcastTransactions",e)})}storeTransactions(e){return n.__awaiter(this,void 0,void 0,function*(){if(i.ObjectHelper.isEmpty(e))throw new c.ApiError("The request must be defined");if(s.ArrayHelper.isEmpty(e.trytes))throw new c.ApiError("The request.trytes must not be empty");return this.sendCommand("storeTransactions",e)})}getMissingTransactions(){return n.__awaiter(this,void 0,void 0,function*(){return this.sendCommand("getMissingTransactions",{})})}checkConsistency(e){return n.__awaiter(this,void 0,void 0,function*(){if(i.ObjectHelper.isEmpty(e))throw new c.ApiError("The request must be defined");if(s.ArrayHelper.isEmpty(e.tails))throw new c.ApiError("The request.tails must not be empty");return this.sendCommand("checkConsistency",e)})}wereAddressesSpentFrom(e){return n.__awaiter(this,void 0,void 0,function*(){if(i.ObjectHelper.isEmpty(e))throw new c.ApiError("The request must be defined");if(s.ArrayHelper.isEmpty(e.addresses))throw new c.ApiError("The request.addresses must not be empty");return this.sendCommand("wereAddressesSpentFrom",e)})}sendCommand(e,t){return n.__awaiter(this,void 0,void 0,function*(){return this._logger.info(`===> ApiClient::${e}`,t),Object.defineProperty(t,"command",{value:e,enumerable:!0}),this._networkClient.json(t,"POST",void 0,this.createHeaders()).then(t=>(this._logger.info(`===> ${e}`,t),t)).catch(t=>{if(this._logger.error(`===> ${e} Error`,t),t.additional&&t.additional.errorResponse)try{const e=JSON.parse(t.additional.errorResponse);e.error?(delete t.additional.errorResponse,t.additional.apiError=e.error):e.exception&&(delete t.additional.errorResponse,t.additional.apiError=e.exception)}catch(e){}throw t})})}createHeaders(){const e=this._additionalHeaders||{};return e["X-IOTA-API-Version"]=this._apiVersion,e}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(16);class s extends n.FactoryBase{constructor(){super()}static instance(){return s._instance||(s._instance=new s),s._instance}getInstance(){return s.instance()}}t.ProofOfWorkFactory=s},function(e,t){e.exports=require("big-integer")},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(1);n.__exportStar(r(18),t),n.__exportStar(r(44),t),n.__exportStar(r(28),t),n.__exportStar(r(46),t),n.__exportStar(r(65),t),n.__exportStar(r(45),t),n.__exportStar(r(66),t)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),s=r(6),o=r(3),i=r(0),a=r(21),u=r(24),c=r(10),l=r(23),h=r(7),d=r(13),p=r(12),y=r(14),g=r(26),f=r(8),T=r(2),m=r(18),b=r(28),_=r(46);t.MultiSigClient=class{constructor(e,t=new a.TimeService){this._apiClient=e,this._timeService=t}static getKey(e,t,r){if(!i.ObjectHelper.isType(e,h.Hash))throw new m.BusinessError("The seed should be an object of type Hash");if(!o.NumberHelper.isInteger(t)||t<0)throw new m.BusinessError("The index should be a number >= 0");if(!o.NumberHelper.isInteger(r)||r<1||r>3)throw new m.BusinessError("The security must be between 1 and 3",{security:r});return f.Trits.fromArray(u.ISS.key(e,t,r)).toTrytes()}static getDigest(e,t,r){if(!i.ObjectHelper.isType(e,h.Hash))throw new m.BusinessError("The seed should be an object of type Hash");if(!o.NumberHelper.isInteger(t)||t<0)throw new m.BusinessError("The index should be a number >= 0");if(!o.NumberHelper.isInteger(r)||r<1||r>3)throw new m.BusinessError("The security must be between 1 and 3",{security:r});const n=u.ISS.key(e,t,r);return f.Trits.fromArray(u.ISS.digests(n)).toTrytes()}static validateAddress(e,t){if(!i.ObjectHelper.isType(e,c.Address))throw new m.BusinessError("The address should be an object of type Address");if(!s.ArrayHelper.isTyped(t,T.Trytes))throw new m.BusinessError("The digests should be an array of type Trytes");return e.toTrytes().toString()===(new _.MultiSigAddress).finalize(t).toTrytes().toString()}static addSignature(e,t,r){if(!i.ObjectHelper.isType(e,l.Bundle))throw new m.BusinessError("The bundle should be an object of type Bundle");if(!s.ArrayHelper.isTyped(e.transactions,y.Transaction))throw new m.BusinessError("The bundle.transactions should be an array of type Transaction");if(!i.ObjectHelper.isType(t,c.Address))throw new m.BusinessError("The address should be an object of type Address");if(!i.ObjectHelper.isType(r,T.Trytes))throw new m.BusinessError("The key should be an object of type Trytes");const n=f.Trits.fromTrytes(r).toArray(),o=n.length/3/2187;let a=0;const u=t.toTrytes().toString();for(let t=0;t<e.transactions.length;t++)if(e.transactions[t].address.toTrytes().toString()===u){if(e.transactions[t].signatureMessageFragment.toTrytes().toString()===d.SignatureMessageFragment.EMPTY.toTrytes().toString()){b.BundleHelper.signTransactions(e,t,a%3,n,u,o);break}a++}}prepareTransfer(e,t,r,a,u){return n.__awaiter(this,void 0,void 0,function*(){if(!i.ObjectHelper.isType(e,c.Address))throw new m.BusinessError("The address should be an object of type Address");if(!o.NumberHelper.isInteger(t)||t<0)throw new m.BusinessError("The securitySum should be a number >= 0");if(!o.NumberHelper.isInteger(r)||r<0)throw new m.BusinessError("The balance should be a number >= 0");if(!s.ArrayHelper.isTyped(a,g.Transfer))throw new m.BusinessError("The transfers should be an array of type Transfer");if(!i.ObjectHelper.isEmpty(u)&&!i.ObjectHelper.isType(u,c.Address))throw new m.BusinessError("The remainderAddress should be an object of type Address");const n=T.Trytes.fromString("");a.forEach(e=>{e.message=e.message?e.message:n,e.tag=e.tag||p.Tag.EMPTY});const l=b.BundleHelper.prepareBundle(this._timeService,a);if(0===l.totalValue)throw new m.BusinessError("The total transfer value is 0, the transfer does not require a signature");let h=r;if(0===h){const t={addresses:[e.toTrytes().toString()],threshold:100},r=yield this._apiClient.getBalances(t);h=parseInt(r.balances[0],10)}if(l.totalValue>h)throw new m.BusinessError("Not enough balance to satisfy the value",{totalValue:l.totalValue,totalBalance:h});const d=Math.floor(this._timeService.msSinceEpoch()/1e3);if(l.bundle.addTransactions(t,e,-h,l.lastTag,d),h>l.totalValue){if(i.ObjectHelper.isEmpty(u))throw new m.BusinessError("Transfer has remainder but no remainder address was provided");l.bundle.addTransactions(1,u,h-l.totalValue,l.lastTag,d)}return b.BundleHelper.finalizeBundle(l.bundle),l.bundle.addSignatureMessageFragments(l.signatureMessageFragments),l.bundle})}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),s=r(6),o=r(3),i=r(0),a=r(20),u=r(34),c=r(21),l=r(24),h=r(27),d=r(10),p=r(22),y=r(23),g=r(7),f=r(36),T=r(12),m=r(14),b=r(26),_=r(8),w=r(2),E=r(18),H=r(44),S=r(28),A=r(67);class N{constructor(e,t,r,n,s){if(i.ObjectHelper.isEmpty(e))throw new E.BusinessError("The apiClient must not be empty");this._apiClient=e,this._proofOfWork=t||new A.ProofOfWorkApi(e),this._timeService=r||new c.TimeService,this._backgroundTaskService=n||new u.BackgroundTaskService,this._logger=s||new a.NullLogger}getTransactionsInProgress(){return n.__awaiter(this,void 0,void 0,function*(){this._logger.info("===> TransactionClient::getTransactionsInProgress");const e=yield this._apiClient.getTips();if(e&&e.hashes){const t=e.hashes.map(e=>g.Hash.fromTrytes(w.Trytes.fromString(e)));return this._logger.info("<=== TransactionClient::getTransactionsInProgress",t),t}return this._logger.info("<=== TransactionClient::getTransactionsInProgress",[]),[]})}findTransactions(e,t,r,o){return n.__awaiter(this,void 0,void 0,function*(){this._logger.info("===> TransactionClient::findTransactions",e,t,r,o);const n=null!=e&&e.length>0,i=null!=t&&t.length>0,a=null!=r&&r.length>0,u=null!=o&&o.length>0;if(n&&!s.ArrayHelper.isTyped(e,g.Hash))throw new E.BusinessError("The bundles must be an array of type Hash");if(i&&!s.ArrayHelper.isTyped(t,d.Address))throw new E.BusinessError("The addresses must be an array of type Address");if(a&&!s.ArrayHelper.isTyped(r,T.Tag))throw new E.BusinessError("The tags must be an array of type Tag");if(u&&!s.ArrayHelper.isTyped(o,g.Hash))throw new E.BusinessError("The approvees must be an array of type Hash");if(!(n||i||a||u))throw new E.BusinessError("You must provide bundles, addresses, tags or approvees");const c={bundles:n?e.map(e=>e.toTrytes().toString()):void 0,addresses:i?t.map(e=>e.toTrytes().toString()):void 0,tags:a?r.map(e=>e.toTrytes().toString()):void 0,approvees:u?o.map(e=>e.toTrytes().toString()):void 0},l=yield this._apiClient.findTransactions(c);if(l&&l.hashes){const e=l.hashes.map(e=>g.Hash.fromTrytes(w.Trytes.fromString(e)));return this._logger.info("<=== TransactionClient::findTransactions",e),e}return this._logger.info("<=== TransactionClient::findTransactions",[]),[]})}getTransactionsObjects(e){return n.__awaiter(this,void 0,void 0,function*(){if(this._logger.info("===> TransactionClient::getTransactionsObjects",e),!s.ArrayHelper.isTyped(e,g.Hash))throw new E.BusinessError("The transactionHashes must be an array of type Hash");const t={hashes:e.map(e=>e.toTrytes().toString())},r=yield this._apiClient.getTrytes(t);if(r&&r.trytes){const e=r.trytes.map(e=>m.Transaction.fromTrytes(w.Trytes.fromString(e)));return this._logger.info("<=== TransactionClient::getTransactionsObjects",e),e}return this._logger.info("<=== TransactionClient::getTransactionsObjects",[]),[]})}getLatestInclusion(e){return n.__awaiter(this,void 0,void 0,function*(){if(this._logger.info("===> TransactionClient::transactionHashes"),!s.ArrayHelper.isTyped(e,g.Hash))throw new E.BusinessError("The transactionHashes must be an array of type Hash");const t=yield this._apiClient.getNodeInfo();if(t&&o.NumberHelper.isInteger(t.latestSolidSubtangleMilestone)){const r={transactions:e.map(e=>e.toTrytes().toString()),tips:[t.latestSolidSubtangleMilestone]},n=yield this._apiClient.getInclusionStates(r);return n&&n.states?(this._logger.info("<=== TransactionClient::transactionHashes",n.states),n.states):(this._logger.info("<=== TransactionClient::transactionHashes",[]),[])}throw new E.BusinessError("The node could not provide the latestSolidSubtangleMilestone")})}getNewAddress(e,t,r,s,a){return n.__awaiter(this,void 0,void 0,function*(){if(this._logger.info("===> TransactionClient::getNewAddress",e,t,r,s,a),!i.ObjectHelper.isType(e,g.Hash))throw new E.BusinessError("The seed must be of type Hash");if(!i.ObjectHelper.isEmpty(t)&&!i.ObjectHelper.isType(t,Number))throw new E.BusinessError("The startIndex must be an integer",{startIndex:t});const n=t||0;if(n<0)throw new E.BusinessError("The startIndex must be >= 0",{localStartIndex:n});const u=o.NumberHelper.isInteger(r),c=a||p.AddressSecurity.medium;let l;if(u){if(!o.NumberHelper.isInteger(r)||r<0)throw new E.BusinessError("The endIndex must be a number >= 0",{endIndex:r});const n=r-t+1;if(n<=0||n>N.MAX_INPUTS)throw new E.BusinessError(`The total must be > 0 and <= ${N.MAX_INPUTS}`,{total:n});l=yield this.getAddressesByIndex(e,t,r,s,c)}else l=yield this.getAddressesToUnused(e,t,s,c);return this._logger.info("<=== TransactionClient::getNewAddress",l),l})}getAddressesByIndex(e,t,r,s,a){return n.__awaiter(this,void 0,void 0,function*(){if(this._logger.info("===> TransactionClient::getAddressesByIndex",e,t,r,s,a),!i.ObjectHelper.isType(e,g.Hash))throw new E.BusinessError("The seed must be of type Hash");if(!o.NumberHelper.isInteger(t)||t<0)throw new E.BusinessError("The startIndex must be a number >= 0",{startIndex:t});if(!o.NumberHelper.isInteger(r)||r<0)throw new E.BusinessError("The endIndex must be a number >= 0",{endIndex:r});const n=r-t+1;if(n<=0||n>N.MAX_INPUTS)throw new E.BusinessError(`The total must be > 0 and <= ${N.MAX_INPUTS}`,{total:n});if(!o.NumberHelper.isInteger(a)||a<1||a>3)throw new E.BusinessError("The security must be between 1 and 3",{security:a});const u=[];for(let r=0;r<n;r++)u.push(this.generateAddress(e,t+r,a,s));return this._logger.info("<=== TransactionClient::getAddressesByIndex",u),Promise.resolve(u)})}getAddressesToUnused(e,t,r,s){return n.__awaiter(this,void 0,void 0,function*(){if(this._logger.info("===> TransactionClient::getAddressesToUnused",e,t,r,s),!i.ObjectHelper.isType(e,g.Hash))throw new E.BusinessError("The seed must be of type Hash");if(!o.NumberHelper.isInteger(t)||t<0)throw new E.BusinessError("The startIndex must be a number >= 0",{startIndex:t});if(!o.NumberHelper.isInteger(s)||s<1||s>3)throw new E.BusinessError("The security must be between 1 and 3",{security:s});let n,a=t;const u=[];do{const t=this.generateAddress(e,a++,s,r);u.push(t);const o=t.toTrytes().toString(),i={addresses:[o]},c=yield this._apiClient.wereAddressesSpentFrom(i);if(!(n=!!(c&&c.states&&c.states.length>0)&&c.states[0])){const e={addresses:[o]},t=yield this._apiClient.findTransactions(e);n=t&&t.hashes&&t.hashes.length>0}}while(n);return this._logger.info("<=== TransactionClient::getAddressesToUnused",u),Promise.resolve(u)})}getInputs(e,t,r,s,a){return n.__awaiter(this,void 0,void 0,function*(){if(this._logger.info("===> TransactionClient::getInputs",e,t,r,s,a),!i.ObjectHelper.isType(e,g.Hash))throw new E.BusinessError("The seed must be of type Hash");if(!o.NumberHelper.isInteger(t)||t<0)throw new E.BusinessError("The startIndex must be a number >= 0",{startIndex:t});if(!o.NumberHelper.isInteger(s)||s<1||s>3)throw new E.BusinessError("The security must be between 1 and 3",{security:s});if(!o.NumberHelper.isInteger(a)||a<0)throw new E.BusinessError("The totalRequired must be >= 0",{totalRequired:a});const n=yield this.getNewAddress(e,t,r,!1,s),u={addresses:n.map(e=>e.toTrytes().toString()),threshold:100},c=yield this._apiClient.getBalances(u),l=[];let h=0;if(c)for(let e=0;e<n.length;e++){const r=parseInt(c.balances[e],10);if(r>0&&(l.push(f.Input.fromParams(n[e],s,t+e,r)),h+=r,a>0&&h>=a))break}const d={inputs:l,totalBalance:h};if(this._logger.info("<=== TransactionClient::getInputs",d),a>0&&h<a)throw new E.BusinessError("Not enough combined balance in the addresses to satisfy the total required",{totalRequired:a,totalBalance:h});return d})}prepareTransfers(e,t,r){return n.__awaiter(this,void 0,void 0,function*(){if(this._logger.info("===> TransactionClient::prepareTransfers",e,t,r),!i.ObjectHelper.isType(e,g.Hash))throw new E.BusinessError("The seed must be of type Hash");if(!s.ArrayHelper.isTyped(t,b.Transfer))throw new E.BusinessError("The transfers must be an array of Transfer objects");const n=r||{};n.security=n.security||p.AddressSecurity.medium;const o=w.Trytes.fromString(""),a=!i.ObjectHelper.isEmpty(n.hmacKey);let u=!1;t.forEach(e=>{e.message=e.message?e.message:o,e.tag=e.tag||T.Tag.EMPTY,a&&e.value>0&&(e.message=w.Trytes.fromString(N.NULL_HASH_TRYTES+e.message.toString()),u=!0)});const c=S.BundleHelper.prepareBundle(this._timeService,t),l=c.bundle,h=c.lastTag,d=c.totalValue,y=c.signatureMessageFragments;if(d>0)if(n.inputs){const t={addresses:n.inputs.map(e=>e.address.toTrytes().toString()),threshold:100},r=yield this._apiClient.getBalances(t),s=[];let o=0;for(let e=0;e<r.balances.length;e++){const t=parseInt(r.balances[e],10);if(t>0&&(o+=t,n.inputs[e].balance=t,s.push(n.inputs[e]),o>=d))break}if(d>o)throw new E.BusinessError("Not enough balance in the input addresses to satisfy the total for the transfer");yield this.addRemainder(e,l,n,s,y,d,h,u)}else{const t=yield this.getInputs(e,0,void 0,n.security,d);yield this.addRemainder(e,l,n,t.inputs,y,d,h,u)}else S.BundleHelper.finalizeBundle(l),l.addSignatureMessageFragments(y);return l.transactions=l.transactions.reverse(),this._logger.info("<=== TransactionClient::prepareTransfers",l),l})}attachToTangle(e,t,r,a){return n.__awaiter(this,void 0,void 0,function*(){if(this._logger.info("===> TransactionClient::attachToTangle",e,t,r,a),!i.ObjectHelper.isType(e,y.Bundle))throw new E.BusinessError("The bundle must be an array of type Bundle");if(!s.ArrayHelper.isTyped(e.transactions,m.Transaction))throw new E.BusinessError("The bundle.transactions must be an array of type Transaction");if(!o.NumberHelper.isInteger(t)||t<=0)throw new E.BusinessError("The depth must be a number > 0",{depth:t});if(!o.NumberHelper.isInteger(r)||r<=0)throw new E.BusinessError("The minWeightMagnitude must be a number > 0",{minWeightMagnitude:r});const n={depth:t,reference:a?a.toTrytes().toString():void 0},u=yield this._apiClient.getTransactionsToApprove(n),c=(yield this._proofOfWork.pow(g.Hash.fromTrytes(w.Trytes.fromString(u.trunkTransaction)),g.Hash.fromTrytes(w.Trytes.fromString(u.branchTransaction)),e.transactions.map(e=>e.toTrytes()),r)).map(e=>m.Transaction.fromTrytes(e)),l=new y.Bundle;return l.transactions=c,this._logger.info("<=== TransactionClient::attachToTangle",l),l})}sendTransactions(e,t,r,s){return n.__awaiter(this,void 0,void 0,function*(){this._logger.info("===> TransactionClient::sendTransactions",e,t,r,s);const n=yield this.attachToTangle(e,t,r,s),o={trytes:n.transactions.map(e=>e.toTrytes().toString())};yield this._apiClient.storeTransactions(o);const i={trytes:o.trytes};return yield this._apiClient.broadcastTransactions(i),this._logger.info("<=== TransactionClient::sendTransactions",n),n})}sendTransfer(e,t,r,s,o,i){return n.__awaiter(this,void 0,void 0,function*(){this._logger.info("===> TransactionClient::sendTransfer",e,t,r,s,o,i);const n=yield this.prepareTransfers(e,s,o),a=yield this.sendTransactions(n,t,r,i);return this._logger.info("<=== TransactionClient::sendTransfer",a),a})}isPromotable(e){return n.__awaiter(this,void 0,void 0,function*(){if(this._logger.info("===> TransactionClient::isPromotable",e),!i.ObjectHelper.isType(e,g.Hash))throw new E.BusinessError("The transactionTail must be an object of type Hash");const t={tails:[e.toTrytes().toString()]},r=yield this._apiClient.checkConsistency(t);return this._logger.info("<=== TransactionClient::isPromotable",r.state),r.state})}isReattachable(e){return n.__awaiter(this,void 0,void 0,function*(){if(this._logger.info("===> TransactionClient::isReattachable",e),!s.ArrayHelper.isTyped(e,d.Address))throw new E.BusinessError("The addresses must be an object of type Address");const t={};for(let r=0;r<e.length;r++){const n=e[r].toTrytes().toString();t[n]=[]}const r=yield this.findTransactionObjects(void 0,e),n=[];let o;if(r.forEach(e=>{if(e.value.toNumber()<0){const r=e.address,s=h.TransactionHelper.hash(e);t[r.toTrytes().toString()].push(s),n.push(s)}}),n.length>0){const r=yield this.getLatestInclusion(n);o=e.map(e=>{let s=!0;const o=t[e.toTrytes().toString()];for(let e=0;e<o.length;e++){const t=n.indexOf(o[e]);if(!(s=!r[t]))break}return s})}else{o=[];for(let t=0;t<e.length;t++)o.push(!0)}return this._logger.info("<=== TransactionClient::isReattachable",o),o})}promoteTransaction(e,t,r,a,u){return n.__awaiter(this,void 0,void 0,function*(){if(this._logger.info("===> TransactionClient::promoteTransaction",e,t,r,a,u),!i.ObjectHelper.isType(e,g.Hash))throw new E.BusinessError("The transactionTail must be an object of type Hash");if(!o.NumberHelper.isInteger(t)||t<=0)throw new E.BusinessError("The depth must be a number > 0",{depth:t});if(!o.NumberHelper.isInteger(r)||r<=0)throw new E.BusinessError("The minWeightMagnitude must be a number > 0",{minWeightMagnitude:r});if(!s.ArrayHelper.isTyped(a,b.Transfer))throw new E.BusinessError("The transfers must an array of Transfer objects");const c=u||{};if(i.ObjectHelper.isEmpty(c.interrupt)&&(c.interrupt=!1),!1===c.interrupt||"function"==typeof c.interrupt&&!c.interrupt()){if(yield this.isPromotable(e)){const s=yield this.sendTransfer(g.Hash.fromTrytes(a[0].address.toTrytes()),t,r,a,void 0,e);return o.NumberHelper.isInteger(c.delay)?this._backgroundTaskService.create(()=>n.__awaiter(this,void 0,void 0,function*(){return this.promoteTransaction(e,t,r,a,c)}),c.delay):(this._logger.info("<=== TransactionClient::promoteTransaction",s),s)}throw new E.BusinessError("Transaction is not promotable")}this._logger.info("<=== TransactionClient::promoteTransaction",void 0)})}getBundle(e){return n.__awaiter(this,void 0,void 0,function*(){if(this._logger.info("===> TransactionClient::getBundle",e),!i.ObjectHelper.isType(e,g.Hash))throw new E.BusinessError("The transactionHash must be an object of type Hash");const t=yield this.traverseBundle(e),r=new y.Bundle;if(r.transactions=t,!S.BundleHelper.isValid(r))throw new E.BusinessError("Invalid bundle provided");return this._logger.info("<=== TransactionClient::getBundle",r),r})}traverseBundle(e,t){return n.__awaiter(this,void 0,void 0,function*(){if(this._logger.info("===> TransactionClient::traverseBundle",e,t),!i.ObjectHelper.isType(e,g.Hash))throw new E.BusinessError("The trunkTransaction must be an object of type Hash");const r=[];let n=e,s=t;do{const e={hashes:[n.toTrytes().toString()]},t=yield this._apiClient.getTrytes(e),o=!i.ObjectHelper.isEmpty(t)&&!i.ObjectHelper.isEmpty(t.trytes)&&t.trytes.length>0?t.trytes[0]:void 0;if(i.ObjectHelper.isEmpty(o))throw new E.BusinessError("Bundle transactions not visible");const a=m.Transaction.fromTrytes(w.Trytes.fromString(o)),u=!i.ObjectHelper.isEmpty(s);if(!u&&0!==a.currentIndex.toNumber())throw new E.BusinessError("Invalid tail transaction supplied");const c=u?s:a.bundle;n=void 0,s=void 0,c.toTrytes().toString()===a.bundle.toTrytes().toString()&&(r.push(a),0===a.lastIndex.toNumber()&&0===a.currentIndex.toNumber()||(n=a.trunkTransaction,s=c))}while(void 0!==n);return this._logger.info("<=== TransactionClient::traverseBundle",r),r})}reattachBundle(e,t,r){return n.__awaiter(this,void 0,void 0,function*(){this._logger.info("===> TransactionClient::reattachBundle",e,t,r);const n=yield this.getBundle(e);n.transactions=n.transactions.reverse();const s=yield this.sendTransactions(n,t,r);return this._logger.info("<=== TransactionClient::reattachBundle",s),s})}rebroadcastBundle(e){return n.__awaiter(this,void 0,void 0,function*(){this._logger.info("===> TransactionClient::rebroadcastBundle",e);const t=yield this.getBundle(e),r={trytes:t.transactions.reverse().map(e=>e.toTrytes().toString())};return yield this._apiClient.broadcastTransactions(r),this._logger.info("<=== TransactionClient::rebroadcastBundle",t),t})}findTransactionObjects(e,t,r,s){return n.__awaiter(this,void 0,void 0,function*(){this._logger.info("===> TransactionClient::findTransactionObjects",e,t,r,s);const n=yield this.findTransactions(e,t,r,s);if(n.length>0){const e=yield this.getTransactionsObjects(n);return this._logger.info("<=== TransactionClient::findTransactionObjects",e),e}return this._logger.info("<=== TransactionClient::findTransactionObjects",[]),[]})}getTransfers(e,t,r,s,a){return n.__awaiter(this,void 0,void 0,function*(){if(this._logger.info("===> TransactionClient::getTransfers",e,t,r,s,a),!i.ObjectHelper.isType(e,g.Hash))throw new E.BusinessError("The seed must be of type Hash");let n=t;o.NumberHelper.isInteger(n)||(n=0);const u=yield this.getNewAddress(e,n,r,!1,s),c=yield this.bundlesFromAddresses(u,a);return this._logger.info("<=== TransactionClient::getTransfers",c),c})}getAccountData(e,t,r,s){return n.__awaiter(this,void 0,void 0,function*(){if(this._logger.info("===> TransactionClient::getAccountData",e,t,r,s),!i.ObjectHelper.isType(e,g.Hash))throw new E.BusinessError("The seed must be of type Hash");let n=t;o.NumberHelper.isInteger(n)||(n=0);const a=yield this.getNewAddress(e,n,r,!1,s||p.AddressSecurity.medium),u=yield this.bundlesFromAddresses(a,!0),c={latestAddress:a.pop(),addresses:a,transfers:u,inputs:[],balance:0},l={addresses:c.addresses.map(e=>e.toTrytes().toString()),threshold:100},h=yield this._apiClient.getBalances(l);for(let e=0;e<h.balances.length;e++){const t=parseInt(h.balances[e],10);t>0&&(c.inputs.push(f.Input.fromParams(c.addresses[e],s||p.AddressSecurity.medium,n+e,t)),c.balance+=t)}return this._logger.info("<=== TransactionClient::getAccountData",c),c})}bundlesFromAddresses(e,t){return n.__awaiter(this,void 0,void 0,function*(){const r=yield this.findTransactionObjects(void 0,e,void 0,void 0),n=new Set,s=new Set;if(r.forEach(e=>{0===e.currentIndex.toNumber()?n.add(h.TransactionHelper.hash(e).toTrytes().toString()):s.add(e.bundle.toTrytes().toString())}),s.size>0){(yield this.findTransactionObjects(Array.from(s).map(e=>g.Hash.fromTrytes(w.Trytes.fromString(e))))).forEach(e=>{0===e.currentIndex.toNumber()&&n.add(h.TransactionHelper.hash(e).toTrytes().toString())})}const o=[],i=Array.from(n);let a;t&&(a=yield this.getLatestInclusion(i.map(e=>g.Hash.fromTrytes(w.Trytes.fromString(e)))));for(let e=0;e<i.length;e++){const t=yield this.getBundle(g.Hash.fromTrytes(w.Trytes.fromString(i[e])));t.inclusionState=a?a[e]:void 0,o.push(t)}return o.sort((e,t)=>{const r=e.transactions[0].attachmentTimestamp.toNumber(),n=t.transactions[0].attachmentTimestamp.toNumber();return r<n?-1:r>n?1:0}),o})}generateAddress(e,t,r,n){const s=l.ISS.key(e,t,r),o=l.ISS.digests(s),i=l.ISS.address(o);let a=_.Trits.fromArray(i).toTrytes().toString();return n&&(a+=H.AddressHelper.createChecksum(i,9)),d.Address.fromTrytes(w.Trytes.fromString(a))}addRemainder(e,t,r,s,o,a,u,c){return n.__awaiter(this,void 0,void 0,function*(){let n=a;for(let a=0;a<s.length;a++){const l=Math.floor(this._timeService.msSinceEpoch()/1e3);if(t.addTransactions(s[a].security,s[a].address,-s[a].balance,u,l),s[a].balance>=n){const h=s[a].balance-n;if(h>0&&!i.ObjectHelper.isEmpty(r)&&i.ObjectHelper.isType(r.remainderAddress,d.Address))t.addTransactions(1,r.remainderAddress,h,u,l),S.BundleHelper.signInputs(e,t,r,o,s,c);else if(h>0){let n=0;for(let e=0;e<s.length;e++)n=Math.max(s[e].keyIndex,n);n++;const i=yield this.getAddressesToUnused(e,n,!1,r.security),a=Math.floor(this._timeService.msSinceEpoch()/1e3);t.addTransactions(1,i[i.length-1],h,u,a),S.BundleHelper.signInputs(e,t,r,o,s,c)}else S.BundleHelper.signInputs(e,t,r,o,s,c)}else n-=s[a].balance}})}}N.NULL_HASH_TRYTES="9".repeat(243),N.MAX_INPUTS=500,t.TransactionClient=N},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),s=r(6),o=r(3),i=r(0),a=r(9),u=r(7),c=r(2),l=r(18);t.ProofOfWorkApi=class{constructor(e){if(i.ObjectHelper.isEmpty(e))throw new l.BusinessError("The apiClient must not be empty");this._apiClient=e}initialize(){return n.__awaiter(this,void 0,void 0,function*(){return Promise.resolve()})}pow(e,t,r,l){return n.__awaiter(this,void 0,void 0,function*(){if(!i.ObjectHelper.isType(e,u.Hash))throw new a.CryptoError("The trunkTransaction must be an object of type Hash");if(!i.ObjectHelper.isType(t,u.Hash))throw new a.CryptoError("The branchTransaction must be an object of type Hash");if(!s.ArrayHelper.isTyped(r,c.Trytes))throw new a.CryptoError("The trytes must be an array of type Trytes");if(!o.NumberHelper.isInteger(l)||l<=0)throw new a.CryptoError("The minWeightMagnitude must be > 0");const n={trunkTransaction:e.toString(),branchTransaction:t.toString(),minWeightMagnitude:l,trytes:r.map(e=>e.toString())},h=yield this._apiClient.attachToTangle(n);if(i.ObjectHelper.isEmpty(h)||s.ArrayHelper.isEmpty(h.trytes))throw new a.CryptoError("The attachToTangleRequest did not return any trytes");return h.trytes.map(e=>c.Trytes.fromString(e))})}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),s=r(30),o=r(31),i=r(32),a=r(48),u=r(50),c=r(51);class l{static initialize(){return n.__awaiter(this,void 0,void 0,function*(){return l._isInitialized||(l._isInitialized=!0,s.NetworkClientFactory.instance().register("default",(e,t,r)=>new u.NetworkClient(e,t,r)),i.RngServiceFactory.instance().register("default",()=>new c.RngService),o.PlatformCryptoFactory.instance().register("default",()=>new a.PlatformCrypto)),Promise.resolve()})}}l._isInitialized=!1,t.PAL=l},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("https")},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),s=r(3),o=r(0),i=r(9),a=r(43),u=r(2),c=n.__importStar(r(72)),l=n.__importStar(r(73)),h=n.__importStar(r(74)),d=n.__importStar(r(75)),p=n.__importStar(r(76));t.ProofOfWorkNodeJs=class extends a.ProofOfWorkBase{constructor(e,t){super(t),o.ObjectHelper.isEmpty(e)?this._nodePlatform={pathResolve:d.resolve,pathJoin:d.join,platform:h.platform,lstat:l.lstat,loadLibrary:c.Library}:this._nodePlatform=e}initialize(){const e=Object.create(null,{initialize:{get:()=>super.initialize}});return n.__awaiter(this,void 0,void 0,function*(){yield e.initialize.call(this);const t=this._nodePlatform.pathJoin(d.join(__dirname,"../binaries/")),r=this._nodePlatform.platform();let n=this._nodePlatform.pathJoin(t,r,"libccurl");switch(r){case"darwin":n+=".dylib";break;case"win32":n+=".dll";break;default:n+=".so"}if(!(yield p.promisify(this._nodePlatform.lstat)(n)).isFile())throw new i.CryptoError("Library files does not exist",{libFile:n});this._library=this._nodePlatform.loadLibrary(n,{ccurl_pow:["string",["string","int"]]})})}singlePow(e,t){return n.__awaiter(this,void 0,void 0,function*(){return new Promise((r,n)=>{if(o.ObjectHelper.isEmpty(this._library))throw new i.CryptoError("Library not loaded, have you called initialize");if(!o.ObjectHelper.isType(e,u.Trytes))throw new i.CryptoError("The trytes must be an object of type Trytes");if(!s.NumberHelper.isInteger(t)||t<=0)throw new i.CryptoError("The minWeightMagnitude must be > 0");this._library.ccurl_pow.async(e.toString(),t,(e,t)=>{e?n(e):r(u.Trytes.fromString(t))})})})}}},function(e,t){e.exports=require("ffi")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("os")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("util")}]).default;